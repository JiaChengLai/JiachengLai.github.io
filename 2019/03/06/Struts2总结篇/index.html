<!DOCTYPE html>



  


<html class="theme-next gemini use-motion" lang="Zh-Hans">
<head>
  <meta charset="UTF-8"/>

<script>
    (function(){
        if(''){
            if (prompt('请输入文章密码') !== ''){
                alert('密码错误');
                history.back();
            }
        }
    })();
</script>

<meta http-equiv="X-UA-Compatible" content="IE=edge" />
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"/>
<meta name="theme-color" content="#222">








<meta http-equiv="Cache-Control" content="no-transform" />
<meta http-equiv="Cache-Control" content="no-siteapp" />
















  
  
  <link href="/lib/fancybox/source/jquery.fancybox.css?v=2.1.5" rel="stylesheet" type="text/css" />







<link href="/lib/font-awesome/css/font-awesome.min.css?v=4.6.2" rel="stylesheet" type="text/css" />

<link href="/css/main.css?v=5.1.4" rel="stylesheet" type="text/css" />


  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png?v=5.1.4">


  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32-next.png?v=5.1.4">


  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next.png?v=5.1.4">


  <link rel="mask-icon" href="/images/logo.svg?v=5.1.4" color="#222">





  <meta name="keywords" content="Struts2," />










<meta name="description" content="什么是Struts2Struts2是一个基于MVC设计模式的Web应用框架，它本质上相当于一个servlet，在MVC设计模式中，Struts2作为控制器(Controller)来建立模型与视图的数据交互。Struts2是Struts的下一代产品，是在struts1和WebWork的技术基础上进行了合并的全新的Struts2框架。其全新的Struts2的体系结构与Struts1的体系结构差别巨大。">
<meta name="keywords" content="Struts2">
<meta property="og:type" content="article">
<meta property="og:title" content="Struts2总结篇">
<meta property="og:url" content="http://yoursite.com/2019/03/06/Struts2总结篇/index.html">
<meta property="og:site_name" content="晨">
<meta property="og:description" content="什么是Struts2Struts2是一个基于MVC设计模式的Web应用框架，它本质上相当于一个servlet，在MVC设计模式中，Struts2作为控制器(Controller)来建立模型与视图的数据交互。Struts2是Struts的下一代产品，是在struts1和WebWork的技术基础上进行了合并的全新的Struts2框架。其全新的Struts2的体系结构与Struts1的体系结构差别巨大。">
<meta property="og:locale" content="Zh-Hans">
<meta property="og:image" content="https://hexoblog-1257009793.cos.ap-shanghai.myqcloud.com/19-3-9%20Struts2%E6%80%BB%E7%BB%93%E7%AF%87/%E5%BF%AB%E9%80%9F%E5%85%A5%E9%97%A8%E6%95%88%E6%9E%9C.png">
<meta property="og:image" content="https://hexoblog-1257009793.cos.ap-shanghai.myqcloud.com/19-3-9%20Struts2%E6%80%BB%E7%BB%93%E7%AF%87/Struts2%E7%9A%84%E6%89%A7%E8%A1%8C%E6%B5%81%E7%A8%8B.png">
<meta property="og:image" content="https://hexoblog-1257009793.cos.ap-shanghai.myqcloud.com/19-3-9%20Struts2%E6%80%BB%E7%BB%93%E7%AF%87/Struts2%E6%9E%B6%E6%9E%84.png">
<meta property="og:image" content="https://hexoblog-1257009793.cos.ap-shanghai.myqcloud.com/19-3-9%20Struts2%E6%80%BB%E7%BB%93%E7%AF%87/AOP%E7%BC%96%E7%A8%8B1.png">
<meta property="og:image" content="https://hexoblog-1257009793.cos.ap-shanghai.myqcloud.com/19-3-9%20Struts2%E6%80%BB%E7%BB%93%E7%AF%87/AOP%E7%BC%96%E7%A8%8B2.png">
<meta property="og:image" content="https://hexoblog-1257009793.cos.ap-shanghai.myqcloud.com/19-3-9%20Struts2%E6%80%BB%E7%BB%93%E7%AF%87/ActionContext.png">
<meta property="og:image" content="https://hexoblog-1257009793.cos.ap-shanghai.myqcloud.com/19-3-9%20Struts2%E6%80%BB%E7%BB%93%E7%AF%87/ActionContext%E7%B1%BB%E8%AE%BF%E9%97%AEServletAPI.png">
<meta property="og:image" content="https://hexoblog-1257009793.cos.ap-shanghai.myqcloud.com/19-3-9%20Struts2%E6%80%BB%E7%BB%93%E7%AF%87/ognl%E8%A1%A8%E8%BE%BE%E5%BC%8F.png">
<meta property="og:image" content="https://hexoblog-1257009793.cos.ap-shanghai.myqcloud.com/19-3-9%20Struts2%E6%80%BB%E7%BB%93%E7%AF%87/Struts2%E4%B8%8EOGNL%E8%A1%A8%E8%BE%BE%E5%BC%8F%E7%9A%84%E7%BB%93%E5%90%88.png">
<meta property="og:image" content="https://hexoblog-1257009793.cos.ap-shanghai.myqcloud.com/19-3-9%20Struts2%E6%80%BB%E7%BB%93%E7%AF%87/%E5%8F%82%E6%95%B0%E6%8E%A5%E5%8F%97-%E5%B1%9E%E6%80%A7%E9%A9%B1%E5%8A%A8.png">
<meta property="og:image" content="https://hexoblog-1257009793.cos.ap-shanghai.myqcloud.com/19-3-9%20Struts2%E6%80%BB%E7%BB%93%E7%AF%87/%E5%8F%82%E6%95%B0%E6%8E%A5%E5%8F%97-%E5%AF%B9%E8%B1%A1%E9%A9%B1%E5%8A%A8.png">
<meta property="og:image" content="https://hexoblog-1257009793.cos.ap-shanghai.myqcloud.com/19-3-9%20Struts2%E6%80%BB%E7%BB%93%E7%AF%87/%E5%8F%82%E6%95%B0%E6%8E%A5%E5%8F%97-%E6%A8%A1%E5%9E%8B%E9%A9%B1%E5%8A%A8.png">
<meta property="og:image" content="https://hexoblog-1257009793.cos.ap-shanghai.myqcloud.com/19-3-9%20Struts2%E6%80%BB%E7%BB%93%E7%AF%87/%E9%85%8D%E7%BD%AE%E6%96%87%E4%BB%B6%E4%B8%AD%E5%8F%82%E6%95%B0%E4%BC%A0%E9%80%92.png">
<meta property="og:image" content="https://hexoblog-1257009793.cos.ap-shanghai.myqcloud.com/19-3-9%20Struts2%E6%80%BB%E7%BB%93%E7%AF%87/%E8%A1%A8%E5%8D%95%E6%A0%87%E7%AD%BE.png">
<meta property="og:image" content="https://hexoblog-1257009793.cos.ap-shanghai.myqcloud.com/19-3-9%20Struts2%E6%80%BB%E7%BB%93%E7%AF%87/Struts2%E6%89%A7%E8%A1%8C%E6%B5%81%E7%A8%8B.png">
<meta property="og:updated_time" content="2019-03-24T16:41:47.403Z">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="Struts2总结篇">
<meta name="twitter:description" content="什么是Struts2Struts2是一个基于MVC设计模式的Web应用框架，它本质上相当于一个servlet，在MVC设计模式中，Struts2作为控制器(Controller)来建立模型与视图的数据交互。Struts2是Struts的下一代产品，是在struts1和WebWork的技术基础上进行了合并的全新的Struts2框架。其全新的Struts2的体系结构与Struts1的体系结构差别巨大。">
<meta name="twitter:image" content="https://hexoblog-1257009793.cos.ap-shanghai.myqcloud.com/19-3-9%20Struts2%E6%80%BB%E7%BB%93%E7%AF%87/%E5%BF%AB%E9%80%9F%E5%85%A5%E9%97%A8%E6%95%88%E6%9E%9C.png">



<script type="text/javascript" id="hexo.configurations">
  var NexT = window.NexT || {};
  var CONFIG = {
    root: '/',
    scheme: 'Gemini',
    version: '5.1.4',
    sidebar: {"position":"left","display":"post","offset":12,"b2t":false,"scrollpercent":false,"onmobile":false},
    fancybox: true,
    tabs: true,
    motion: {"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn","sidebar":"slideUpIn"}},
    duoshuo: {
      userId: '0',
      author: 'Author'
    },
    algolia: {
      applicationID: '',
      apiKey: '',
      indexName: '',
      hits: {"per_page":10},
      labels: {"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}
    }
  };
</script>



  <link rel="canonical" href="http://yoursite.com/2019/03/06/Struts2总结篇/"/>





  <title>Struts2总结篇 | 晨</title>
  








</head>

<!--卖萌-->
<script type="text/javascript" src="/js/src/mytitle.js"></script>

<body itemscope itemtype="http://schema.org/WebPage" lang="Zh-Hans">

  
  
    
  

  <div class="container sidebar-position-left page-post-detail">
    <div class="headband"></div>

    <header id="header" class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-wrapper">
  <div class="site-meta ">
    

    <div class="custom-logo-site-title">
      <a href="/"  class="brand" rel="start">
        <span class="logo-line-before"><i></i></span>
        <span class="site-title">晨</span>
        <span class="logo-line-after"><i></i></span>
      </a>
    </div>
      
        <p class="site-subtitle">学无止境</p>
      
  </div>

  <div class="site-nav-toggle">
    <button>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
    </button>
  </div>
</div>

<nav class="site-nav">
  

  
    <ul id="menu" class="menu">
      
        
        <li class="menu-item menu-item-home">
          <a href="/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-home"></i> <br />
            
            Home
          </a>
        </li>
      
        
        <li class="menu-item menu-item-categories">
          <a href="/categories/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-th"></i> <br />
            
            Categories
          </a>
        </li>
      
        
        <li class="menu-item menu-item-archives">
          <a href="/archives/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-archive"></i> <br />
            
            Archives
          </a>
        </li>
      

      
    </ul>
  

  
</nav>



 </div>
    </header>

    <main id="main" class="main">
      <div class="main-inner">
        <div class="content-wrap">
          <div id="content" class="content">
            

  <div id="posts" class="posts-expand">
    

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2019/03/06/Struts2总结篇/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="JiachengLai">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.jpg">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="晨">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">Struts2总结篇</h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2019-03-06T17:36:15+08:00">
                2019-03-06
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">In</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/JavaEE/" itemprop="url" rel="index">
                    <span itemprop="name">JavaEE</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        <h2 id="什么是Struts2"><a href="#什么是Struts2" class="headerlink" title="什么是Struts2"></a>什么是Struts2</h2><p>Struts2是一个基于MVC设计模式的Web应用框架，它本质上相当于一个servlet，在MVC设计模式中，Struts2作为控制器(Controller)来建立模型与视图的数据交互。Struts2是Struts的下一代产品，是在struts1和WebWork的技术基础上进行了合并的全新的Struts2框架。其全新的Struts2的体系结构与Struts1的体系结构差别巨大。Struts2以WebWork为核心，采用拦截器的机制来处理用户的请求，这样的设计也使得业务逻辑控制器能够与ServletAPI完全脱离开，所以Struts2可以理解为WebWork的更新产品。虽然从Struts1到Struts2有着太大的变化，但是相对于WebWork，Struts2的变化很小。</p>
<h2 id="Struts2的优点"><a href="#Struts2的优点" class="headerlink" title="Struts2的优点"></a>Struts2的优点</h2><ul>
<li>拥有简单的插件，只需放入相应的JAR包，任何人都可以扩展Struts框架，比如自定义拦截器、自定义结果类型、自定义标签等，为Struts定制需要的功能，不需要什么特殊配置，并且可以发布给其他人使用</li>
<li>拥有智能的默认设置，不需要另外进行繁琐的设置。使用默认设置就可以完成大多数项目程序开发所需要的功能</li>
<li>Result方式的页面导航，通过Result标签很方便的实现重定向和页面跳转</li>
<li>通过简单、集中的配置来调度业务类，使得配置和修改都非常容易</li>
<li>提供简单、统一的表达式语言来访问所有可供访问的数据</li>
<li>提供强大的、 可以有效减少页面代码的标签</li>
<li>提供标准、强大的验证框架和国际化框架</li>
<li>项目开源，使用及拓展方便</li>
<li>提供Exception处理机制</li>
<li>提供良好的Ajax支持</li>
<li>表单的防止重复提交</li>
<li>显示等待界面</li>
<li>自动封装参数</li>
<li>参数校验</li>
</ul>
<h2 id="快速入门"><a href="#快速入门" class="headerlink" title="快速入门"></a>快速入门</h2><h3 id="JAR包导入"><a href="#JAR包导入" class="headerlink" title="JAR包导入"></a>JAR包导入</h3><p>JAR 包的导入基于<code>struts-2.3.34</code>版本</p>
<p>官网下载<code>struts-2.3.34-all.zip</code>，解压缩，进入其中的apps目录，有一个<code>struts2-blank.war</code>将其解压缩，其中所含的jar包就是Struts2的基本开发包了<br><a id="more"></a></p>
<table>
<thead>
<tr>
<th style="text-align:center">JAR包</th>
<th style="text-align:left">功能</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center"><code>asm-3.3.jar</code></td>
<td style="text-align:left">操作java字节码的类库</td>
</tr>
<tr>
<td style="text-align:center"><code>asm-commons-3.3.jar</code></td>
<td style="text-align:left">提供了基于事件的表现形式</td>
</tr>
<tr>
<td style="text-align:center"><code>asm-tree-3.3.jar</code></td>
<td style="text-align:left">提供了基于对象的表现形式</td>
</tr>
<tr>
<td style="text-align:center"><code>commons-fileupload-1.3.2.jar</code></td>
<td style="text-align:left">Struts2文件上传组件依赖包</td>
</tr>
<tr>
<td style="text-align:center"><code>commons-io-2.2.jar</code></td>
<td style="text-align:left">Struts2的输入输出，传文件依赖的jar</td>
</tr>
<tr>
<td style="text-align:center"><code>commons-lang3-3.2.jar</code></td>
<td style="text-align:left">包含一些数据类型工具，是对java.lang包的增强</td>
</tr>
<tr>
<td style="text-align:center"><code>freemarker-2.3.22.jar</code></td>
<td style="text-align:left">Struts2标签模板使用的类库</td>
</tr>
<tr>
<td style="text-align:center"><code>javassist-3.11.0.GA.jar</code></td>
<td style="text-align:left">JavaScript字节码解释器</td>
</tr>
<tr>
<td style="text-align:center"><code>log4j-api-2.3.jar</code></td>
<td style="text-align:left">Struts2的日志管理组件依赖包的api</td>
</tr>
<tr>
<td style="text-align:center"><code>log4j-core-2.3.jar</code></td>
<td style="text-align:left">Struts2的日志管理组件依赖包</td>
</tr>
<tr>
<td style="text-align:center"><code>ognl-3.0.21.jar</code></td>
<td style="text-align:left">对象图导航语言(<code>Object Graph Navigation Language</code>),Struts2框架通过其读写对象的属性</td>
</tr>
<tr>
<td style="text-align:center"><code>struts2-core-2.3.34.jar</code></td>
<td style="text-align:left">Struts2框架的核心类库</td>
</tr>
<tr>
<td style="text-align:center"><code>xwork-core-2.3.34.jar</code></td>
<td style="text-align:left">WebWork核心库，Struts2的构建基础</td>
</tr>
</tbody>
</table>
<h3 id="创建测试页面"><a href="#创建测试页面" class="headerlink" title="创建测试页面"></a>创建测试页面</h3><p>index.jsp<br><figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">&lt;%@ page contentType=<span class="string">"text/html;charset=UTF-8"</span> language=<span class="string">"java"</span> %&gt;</span><br><span class="line">&lt;html&gt;</span><br><span class="line">&lt;head&gt;</span><br><span class="line">	&lt;title&gt;快速入门&lt;/title&gt;</span><br><span class="line">&lt;/head&gt;</span><br><span class="line">&lt;body&gt;</span><br><span class="line">	&lt;a href="$&#123;pageContext.request.contextPath&#125;/hello/hello.action"&#125;&gt;访问action&lt;/a&gt;</span><br><span class="line">&lt;/body&gt;</span><br><span class="line">&lt;/html&gt;</span><br></pre></td></tr></table></figure></p>
<p>hello.jsp<br><figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">&lt;%@ page contentType=<span class="string">"text/html;charset=UTF-8"</span> language=<span class="string">"java"</span> %&gt;</span><br><span class="line">&lt;html&gt;</span><br><span class="line">&lt;head&gt;</span><br><span class="line">	&lt;title&gt;你好&lt;/title&gt;</span><br><span class="line">&lt;/head&gt;</span><br><span class="line">&lt;body&gt;</span><br><span class="line">	&lt;h1&gt;Hello World!&lt;/h1&gt;</span><br><span class="line">&lt;/body&gt;</span><br><span class="line">&lt;/html&gt;</span><br></pre></td></tr></table></figure></p>
<h3 id="书写Action类"><a href="#书写Action类" class="headerlink" title="书写Action类"></a>书写Action类</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> priv.jc.action;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Hello</span> </span>&#123;</span><br><span class="line">	<span class="function"><span class="keyword">public</span> String <span class="title">toHelloPage</span><span class="params">()</span> </span>&#123;</span><br><span class="line">		System.out.println(<span class="string">"Hello.toHelloPage"</span>);</span><br><span class="line">		<span class="keyword">return</span> <span class="string">"success"</span>;</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="书写struts-xml"><a href="#书写struts-xml" class="headerlink" title="书写struts.xml"></a>书写struts.xml</h3><p>在src根目录下创建<code>struts.xml</code>文件<br><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;!DOCTYPE struts PUBLIC</span></span><br><span class="line"><span class="meta">		"-//Apache Software Foundation//DTD Struts Configuration 2.3//EN"</span></span><br><span class="line"><span class="meta">		"http://struts.apache.org/dtds/struts-2.3.dtd"&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">struts</span>&gt;</span></span><br><span class="line">	<span class="comment">&lt;!--配置一个包package--&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">package</span> <span class="attr">name</span>=<span class="string">"hello"</span> <span class="attr">extends</span>=<span class="string">"struts-default"</span> <span class="attr">namespace</span>=<span class="string">"/hello"</span>&gt;</span></span><br><span class="line">		<span class="comment">&lt;!--配置action 调用toHelloPage()方法 返回success 跳转到helloPage.jsp--&gt;</span></span><br><span class="line">		<span class="tag">&lt;<span class="name">action</span> <span class="attr">name</span>=<span class="string">"hello"</span> <span class="attr">class</span>=<span class="string">"priv.jc.action.Hello"</span> <span class="attr">method</span>=<span class="string">"toHelloPage"</span>&gt;</span></span><br><span class="line">			<span class="comment">&lt;!--配置结果页面的跳转--&gt;</span></span><br><span class="line">			<span class="tag">&lt;<span class="name">result</span> <span class="attr">name</span>=<span class="string">"success"</span>&gt;</span>/helloPage.jsp<span class="tag">&lt;/<span class="name">result</span>&gt;</span></span><br><span class="line">		<span class="tag">&lt;/<span class="name">action</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;/<span class="name">package</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">struts</span>&gt;</span></span><br></pre></td></tr></table></figure></p>
<h3 id="配置struts2核心过滤器"><a href="#配置struts2核心过滤器" class="headerlink" title="配置struts2核心过滤器"></a>配置struts2核心过滤器</h3><p>WEB层的框架都有一个特点就是基于前端控制器的模式，这个前端控制器是由过滤器实现的，所以我们需要配置Struts2的核心过滤器。这个过滤器的名称是StrutsPrepareAndExecuteFilter。</p>
<p>Struts2框架要想执行，所有的请求都需要经过这个前端控制器（核心过滤器），所以需要配置这个核心过滤器。因为这个过滤器完成了框架的部分的功能。那么接下来对过滤器进行配置。在<code>web.xml</code>中进行如下配置<br><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">&lt;?xml version="1.0" encoding="UTF-8"?&gt;</span><br><span class="line"><span class="tag">&lt;<span class="name">web-app</span> <span class="attr">xmlns</span>=<span class="string">"http://xmlns.jcp.org/xml/ns/javaee"</span></span></span><br><span class="line"><span class="tag">		 <span class="attr">xmlns:xsi</span>=<span class="string">"http://www.w3.org/2001/XMLSchema-instance"</span></span></span><br><span class="line"><span class="tag">		 <span class="attr">xsi:schemaLocation</span>=<span class="string">"http://xmlns.jcp.org/xml/ns/javaee http://xmlns.jcp.org/xml/ns/javaee/web-app_4_0.xsd"</span></span></span><br><span class="line"><span class="tag">		 <span class="attr">version</span>=<span class="string">"4.0"</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">filter</span>&gt;</span></span><br><span class="line">		<span class="tag">&lt;<span class="name">filter-name</span>&gt;</span>struts2<span class="tag">&lt;/<span class="name">filter-name</span>&gt;</span></span><br><span class="line">		<span class="tag">&lt;<span class="name">filter-class</span>&gt;</span>org.apache.struts2.dispatcher.ng.filter.StrutsPrepareAndExecuteFilter<span class="tag">&lt;/<span class="name">filter-class</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;/<span class="name">filter</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">filter-mapping</span>&gt;</span></span><br><span class="line">		<span class="tag">&lt;<span class="name">filter-name</span>&gt;</span>struts2<span class="tag">&lt;/<span class="name">filter-name</span>&gt;</span></span><br><span class="line">		<span class="tag">&lt;<span class="name">url-pattern</span>&gt;</span>/*<span class="tag">&lt;/<span class="name">url-pattern</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;/<span class="name">filter-mapping</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">web-app</span>&gt;</span></span><br></pre></td></tr></table></figure></p>
<h3 id="效果"><a href="#效果" class="headerlink" title="效果"></a>效果</h3><p><img src="https://hexoblog-1257009793.cos.ap-shanghai.myqcloud.com/19-3-9%20Struts2%E6%80%BB%E7%BB%93%E7%AF%87/%E5%BF%AB%E9%80%9F%E5%85%A5%E9%97%A8%E6%95%88%E6%9E%9C.png" alt=""></p>
<h3 id="Struts2的执行流程"><a href="#Struts2的执行流程" class="headerlink" title="Struts2的执行流程"></a>Struts2的执行流程</h3><p><img src="https://hexoblog-1257009793.cos.ap-shanghai.myqcloud.com/19-3-9%20Struts2%E6%80%BB%E7%BB%93%E7%AF%87/Struts2%E7%9A%84%E6%89%A7%E8%A1%8C%E6%B5%81%E7%A8%8B.png" alt=""></p>
<p><img src="https://hexoblog-1257009793.cos.ap-shanghai.myqcloud.com/19-3-9%20Struts2%E6%80%BB%E7%BB%93%E7%AF%87/Struts2%E6%9E%B6%E6%9E%84.png" alt=""></p>
<p><img src="https://hexoblog-1257009793.cos.ap-shanghai.myqcloud.com/19-3-9%20Struts2%E6%80%BB%E7%BB%93%E7%AF%87/AOP%E7%BC%96%E7%A8%8B1.png" alt=""></p>
<p><img src="https://hexoblog-1257009793.cos.ap-shanghai.myqcloud.com/19-3-9%20Struts2%E6%80%BB%E7%BB%93%E7%AF%87/AOP%E7%BC%96%E7%A8%8B2.png" alt=""></p>
<h2 id="Struts2的常见配置"><a href="#Struts2的常见配置" class="headerlink" title="Struts2的常见配置"></a>Struts2的常见配置</h2><h3 id="Struts2配置文件的加载顺序"><a href="#Struts2配置文件的加载顺序" class="headerlink" title="Struts2配置文件的加载顺序"></a>Struts2配置文件的加载顺序</h3><p>每次从客户端发送请求到服务器都要先经过Struts2的核心过滤器<code>StrutsPrepareAndExecuteFilter</code>,这个过滤器有两个功能：预处理和执行。在预处理中主要就是来加载配置文件的。对应的是过滤器中的init方法，而执行是用来执行一组拦截器完成部分功能的，对应的是过滤器的doFilter方法。所以我们如果要去了解Struts2的配置文件的加载顺序，那么我们需要查询过滤器的init方法。</p>
<p>StrutsPrepareAndExecuteFilter<br><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">init</span><span class="params">(FilterConfig filterConfig)</span> <span class="keyword">throws</span> ServletException </span>&#123;</span><br><span class="line">	InitOperations init = <span class="keyword">new</span> InitOperations();</span><br><span class="line">	Dispatcher dispatcher = <span class="keyword">null</span>;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">try</span> &#123;</span><br><span class="line">		FilterHostConfig config = <span class="keyword">new</span> FilterHostConfig(filterConfig);</span><br><span class="line">		init.initLogging(config);</span><br><span class="line">		<span class="comment">// 这里调用了InitOperations中的initDispatcher方法 </span></span><br><span class="line">		dispatcher = init.initDispatcher(config);</span><br><span class="line">		init.initStaticContentLoader(config, dispatcher);</span><br><span class="line">		<span class="keyword">this</span>.prepare = <span class="keyword">new</span> PrepareOperations(dispatcher);</span><br><span class="line">		<span class="keyword">this</span>.execute = <span class="keyword">new</span> ExecuteOperations(dispatcher);</span><br><span class="line">		<span class="keyword">this</span>.excludedPatterns = init.buildExcludedPatternsList(dispatcher);</span><br><span class="line">		<span class="keyword">this</span>.postInit(dispatcher, filterConfig);</span><br><span class="line">	&#125; <span class="keyword">finally</span> &#123;</span><br><span class="line">		<span class="keyword">if</span> (dispatcher != <span class="keyword">null</span>) &#123;</span><br><span class="line">			dispatcher.cleanUpAfterInit();</span><br><span class="line">		&#125;</span><br><span class="line"></span><br><span class="line">		init.cleanup();</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<p>在init方法中，调用了init的imtDispatcher的方法来加载配置文件，进入到该代码中</p>
<p>InitOperations<br><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> Dispatcher <span class="title">initDispatcher</span><span class="params">(HostConfig filterConfig)</span> </span>&#123;</span><br><span class="line">	Dispatcher dispatcher = <span class="keyword">this</span>.createDispatcher(filterConfig);</span><br><span class="line">	dispatcher.init();</span><br><span class="line">	<span class="keyword">return</span> dispatcher;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<p>发现这个方法又调用了dispatcher的init方法。进入init方法内部</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">init</span><span class="params">()</span> </span>&#123;</span><br><span class="line">	<span class="keyword">if</span> (<span class="keyword">this</span>.configurationManager == <span class="keyword">null</span>) &#123;</span><br><span class="line">		<span class="keyword">this</span>.configurationManager = <span class="keyword">this</span>.createConfigurationManager(<span class="string">"struts"</span>);</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">try</span> &#123;</span><br><span class="line">		<span class="comment">// ======加载配置文件开始======</span></span><br><span class="line">		<span class="keyword">this</span>.init_FileManager();</span><br><span class="line">		<span class="comment">// 加载 default.properties</span></span><br><span class="line">		<span class="keyword">this</span>.init_DefaultProperties();</span><br><span class="line">		<span class="comment">// 加载 struts-default.xml,struts-plugin.xml,struts.xml</span></span><br><span class="line">		<span class="keyword">this</span>.init_TraditionalXmlConfigurations();</span><br><span class="line">		<span class="comment">// 加载用户自定义struts.properties</span></span><br><span class="line">		<span class="keyword">this</span>.init_LegacyStrutsProperties();</span><br><span class="line">		<span class="comment">// 加载用户配置的提供对象</span></span><br><span class="line">		<span class="keyword">this</span>.init_CustomConfigurationProviders();</span><br><span class="line">		<span class="comment">// 加载web.xml</span></span><br><span class="line">		<span class="keyword">this</span>.init_FilterInitParameters();</span><br><span class="line">		<span class="comment">// 加载标准对象</span></span><br><span class="line">		<span class="keyword">this</span>.init_AliasStandardObjects();</span><br><span class="line">		<span class="comment">// ======加载配置文件结束======</span></span><br><span class="line"></span><br><span class="line">		Container container = <span class="keyword">this</span>.init_PreloadConfiguration();</span><br><span class="line">		container.inject(<span class="keyword">this</span>);</span><br><span class="line">		<span class="keyword">this</span>.init_CheckWebLogicWorkaround(container);</span><br><span class="line">		<span class="keyword">if</span> (!dispatcherListeners.isEmpty()) &#123;</span><br><span class="line">			Iterator i$ = dispatcherListeners.iterator();</span><br><span class="line"></span><br><span class="line">			<span class="keyword">while</span>(i$.hasNext()) &#123;</span><br><span class="line">				DispatcherListener l = (DispatcherListener)i$.next();</span><br><span class="line">				l.dispatcherInitialized(<span class="keyword">this</span>);</span><br><span class="line">			&#125;</span><br><span class="line">		&#125;</span><br><span class="line"></span><br><span class="line">		<span class="keyword">this</span>.errorHandler.init(<span class="keyword">this</span>.servletContext);</span><br><span class="line">	&#125; <span class="keyword">catch</span> (Exception var4) &#123;</span><br><span class="line">		<span class="keyword">if</span> (LOG.isErrorEnabled()) &#123;</span><br><span class="line">			LOG.error(<span class="string">"Dispatcher initialization failed"</span>, var4, <span class="keyword">new</span> String[<span class="number">0</span>]);</span><br><span class="line">		&#125;</span><br><span class="line"></span><br><span class="line">		<span class="keyword">throw</span> <span class="keyword">new</span> StrutsException(var4);</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>得出配置文件加载顺序:</p>
<table>
<thead>
<tr>
<th style="text-align:center">加载顺序</th>
<th style="text-align:center">配置文件</th>
<th style="text-align:left">作用</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center">1</td>
<td style="text-align:center"><code>default.properties</code></td>
<td style="text-align:left">Struts2内部的配置文件</td>
</tr>
<tr>
<td style="text-align:center">2</td>
<td style="text-align:center"><code>struts-default.xml</code></td>
<td style="text-align:left">Struts2内部的配置文件</td>
</tr>
<tr>
<td style="text-align:center">3</td>
<td style="text-align:center"><code>struts-plugin.xml</code></td>
<td style="text-align:left">Struts2内部的配置文件</td>
</tr>
<tr>
<td style="text-align:center">4</td>
<td style="text-align:center"><code>struts.xml</code></td>
<td style="text-align:left">配置action 和 常量</td>
</tr>
<tr>
<td style="text-align:center">5</td>
<td style="text-align:center"><code>struts.properties</code></td>
<td style="text-align:left">配置常量</td>
</tr>
<tr>
<td style="text-align:center">6</td>
<td style="text-align:center"><code>web.xml</code></td>
<td style="text-align:left">配置核心过滤器和常量</td>
</tr>
</tbody>
</table>
<p>配置文件的加载是有一定的顺序的。<code>struts.xml</code>、<code>struts.properties</code>、<code>web.xml</code>都可以修改Struts2的常量的值，<strong>后加载配置文件中常量的值会将先加载的配置文件中常量的值给覆盖</strong>。</p>
<h3 id="Action的配置"><a href="#Action的配置" class="headerlink" title="Action的配置"></a>Action的配置</h3><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;!DOCTYPE struts PUBLIC</span></span><br><span class="line"><span class="meta">		"-//Apache Software Foundation//DTD Struts Configuration 2.3//EN"</span></span><br><span class="line"><span class="meta">		"http://struts.apache.org/dtds/struts-2.3.dtd"&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">struts</span>&gt;</span></span><br><span class="line">	<span class="comment">&lt;!--</span></span><br><span class="line"><span class="comment">	 package:将action配置封装 可在一个package中配置多个action</span></span><br><span class="line"><span class="comment">		name：给包起名字，起标识作用，不能与其他包重复，名字是该包被其他包引用的key</span></span><br><span class="line"><span class="comment">		namespace： 给action访问路径中定义一个命名空间</span></span><br><span class="line"><span class="comment">		extends： 继承一个指定包,继承其他包可以继承其中action定义、拦截器定义等</span></span><br><span class="line"><span class="comment">		abstract： true/false,指定包是否为抽象的；标识性属性，若抽象则该包不能被独立运行，专门被继承</span></span><br><span class="line"><span class="comment">	--&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">package</span> <span class="attr">name</span>=<span class="string">"hello"</span> <span class="attr">extends</span>=<span class="string">"struts-default"</span> <span class="attr">namespace</span>=<span class="string">"/hello"</span>&gt;</span></span><br><span class="line">		<span class="comment">&lt;!--</span></span><br><span class="line"><span class="comment">		 action： 配置action类</span></span><br><span class="line"><span class="comment">			name：指定action访问资源名</span></span><br><span class="line"><span class="comment">			class： action对应的Action类完整类名</span></span><br><span class="line"><span class="comment">			method： 指定调用action中的哪个方法来处理请求，默认是execute方法</span></span><br><span class="line"><span class="comment">			converter： 指定类转换器的类</span></span><br><span class="line"><span class="comment">		--&gt;</span></span><br><span class="line">		<span class="tag">&lt;<span class="name">action</span> <span class="attr">name</span>=<span class="string">"hello"</span> <span class="attr">class</span>=<span class="string">"priv.jc.action.Hello"</span> <span class="attr">method</span>=<span class="string">"toHelloPage"</span>&gt;</span></span><br><span class="line">			<span class="comment">&lt;!--</span></span><br><span class="line"><span class="comment">			 result: 结果配置</span></span><br><span class="line"><span class="comment">				name： 表示结果结果处理的名称，与action方法返回值对应</span></span><br><span class="line"><span class="comment">				type： 指定调用哪个result类来处理结果，默认使用转发</span></span><br><span class="line"><span class="comment">				标签体： 填写页面的相对路径</span></span><br><span class="line"><span class="comment">			--&gt;</span></span><br><span class="line">			<span class="tag">&lt;<span class="name">result</span> <span class="attr">name</span>=<span class="string">"success"</span>&gt;</span>/helloPage.jsp<span class="tag">&lt;/<span class="name">result</span>&gt;</span></span><br><span class="line">		<span class="tag">&lt;/<span class="name">action</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;/<span class="name">package</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">struts</span>&gt;</span></span><br></pre></td></tr></table></figure>
<h3 id="Struts2常量的配置"><a href="#Struts2常量的配置" class="headerlink" title="Struts2常量的配置"></a>Struts2常量的配置</h3><p>Struts2常量配置共有3种方式，分别如下：</p>
<p><strong>在<code>struts.xml</code>文件中使用<code>&lt;constant&gt;</code>元素配置常量</strong><br><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">struts</span>&gt;</span></span><br><span class="line">	....</span><br><span class="line">	 <span class="comment">&lt;!-- </span></span><br><span class="line"><span class="comment">	  i18n国际化，设置默认编码集为UTF-8</span></span><br><span class="line"><span class="comment">		可用于解决post提交的乱码问题  </span></span><br><span class="line"><span class="comment">	 --&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">constant</span> <span class="attr">name</span>=<span class="string">"struts.i18n.encoding"</span> <span class="attr">value</span>=<span class="string">"UTF-8"</span>/&gt;</span></span><br><span class="line">	<span class="comment">&lt;!-- </span></span><br><span class="line"><span class="comment">	 设置使用开发模式</span></span><br><span class="line"><span class="comment">		作用：1.热加载主配置（不需要重启即可生效）</span></span><br><span class="line"><span class="comment">			 2.提供更多的错误信息输出，方便开发时调试</span></span><br><span class="line"><span class="comment">	--&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">constant</span> <span class="attr">name</span>=<span class="string">"struts.devMode"</span> <span class="attr">value</span>=<span class="string">"true"</span>/&gt;</span></span><br><span class="line">	<span class="comment">&lt;!-- 设置开启使用动态方法调用--&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">constant</span> <span class="attr">name</span>=<span class="string">"struts.enable.DynamicMethodInvocation"</span> <span class="attr">value</span>=<span class="string">"true"</span>/&gt;</span></span><br><span class="line">	<span class="comment">&lt;!-- 设置action请求的拓展名为action 或 没有拓展名--&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">constant</span> <span class="attr">name</span>=<span class="string">"struts.action.extension"</span> <span class="attr">value</span>=<span class="string">"action,,"</span>/&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">struts</span>&gt;</span></span><br></pre></td></tr></table></figure></p>
<p><strong>在<code>struts.properties</code>文件中配置常量</strong></p>
<p>在src根目录下创建<code>struts.properties</code><br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">### 设置默认编码集为UTF-8</span><br><span class="line">struts.il8n.encoding=UTF-8</span><br><span class="line">### 设置使用开发模式</span><br><span class="line">struts.devMode=true</span><br><span class="line">### 设置开启动态方法调用</span><br><span class="line">struts.enable.DynamicMethodInvocation=true</span><br><span class="line">### 设置action请求的扩展名为action或者没有扩展名</span><br><span class="line">struts.action.extension=action,,</span><br></pre></td></tr></table></figure></p>
<p><strong>在<code>web.xml</code>中通过<code>&lt;init-param&gt;</code>元素配置常量</strong><br><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line">&lt;?xml version="1.0" encoding="UTF-8"?&gt;</span><br><span class="line"><span class="tag">&lt;<span class="name">web-app</span> <span class="attr">xmlns</span>=<span class="string">"http://xmlns.jcp.org/xml/ns/javaee"</span></span></span><br><span class="line"><span class="tag">		 <span class="attr">xmlns:xsi</span>=<span class="string">"http://www.w3.org/2001/XMLSchema-instance"</span></span></span><br><span class="line"><span class="tag">		 <span class="attr">xsi:schemaLocation</span>=<span class="string">"http://xmlns.jcp.org/xml/ns/javaee http://xmlns.jcp.org/xml/ns/javaee/web-app_4_0.xsd"</span></span></span><br><span class="line"><span class="tag">		 <span class="attr">version</span>=<span class="string">"4.0"</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">filter</span>&gt;</span></span><br><span class="line">		<span class="tag">&lt;<span class="name">filter-name</span>&gt;</span>struts2<span class="tag">&lt;/<span class="name">filter-name</span>&gt;</span></span><br><span class="line">		<span class="tag">&lt;<span class="name">filter-class</span>&gt;</span>org.apache.struts2.dispatcher.ng.filter.StrutsPrepareAndExecuteFilter<span class="tag">&lt;/<span class="name">filter-class</span>&gt;</span></span><br><span class="line">	   <span class="comment">&lt;!--设置默认编码集为UTF-8--&gt;</span></span><br><span class="line">		<span class="tag">&lt;<span class="name">init-param</span>&gt;</span></span><br><span class="line">			<span class="tag">&lt;<span class="name">param-name</span>&gt;</span>struts.i18n.encoding<span class="tag">&lt;/<span class="name">param-name</span>&gt;</span></span><br><span class="line">			<span class="tag">&lt;<span class="name">param-value</span>&gt;</span>UTF-8<span class="tag">&lt;/<span class="name">param-value</span>&gt;</span></span><br><span class="line">		<span class="tag">&lt;/<span class="name">init-param</span>&gt;</span></span><br><span class="line">		<span class="comment">&lt;!--设置使用开发模式--&gt;</span></span><br><span class="line">		<span class="tag">&lt;<span class="name">init-param</span>&gt;</span></span><br><span class="line">			<span class="tag">&lt;<span class="name">param-name</span>&gt;</span>struts.devMode<span class="tag">&lt;/<span class="name">param-name</span>&gt;</span></span><br><span class="line">			<span class="tag">&lt;<span class="name">param-value</span>&gt;</span>true<span class="tag">&lt;/<span class="name">param-value</span>&gt;</span></span><br><span class="line">		<span class="tag">&lt;/<span class="name">init-param</span>&gt;</span></span><br><span class="line">		<span class="comment">&lt;!--设置开启动态方法调用--&gt;</span></span><br><span class="line">		<span class="tag">&lt;<span class="name">init-param</span>&gt;</span></span><br><span class="line">			<span class="tag">&lt;<span class="name">param-name</span>&gt;</span>struts.enable.DynamicMethodInvocation<span class="tag">&lt;/<span class="name">param-name</span>&gt;</span></span><br><span class="line">			<span class="tag">&lt;<span class="name">param-value</span>&gt;</span>true<span class="tag">&lt;/<span class="name">param-value</span>&gt;</span></span><br><span class="line">		<span class="tag">&lt;/<span class="name">init-param</span>&gt;</span></span><br><span class="line">		<span class="comment">&lt;!--设置action请求的扩展名为action或者没有扩展名--&gt;</span></span><br><span class="line">		<span class="tag">&lt;<span class="name">init-param</span>&gt;</span></span><br><span class="line">			<span class="tag">&lt;<span class="name">param-name</span>&gt;</span>struts.action.extension<span class="tag">&lt;/<span class="name">param-name</span>&gt;</span></span><br><span class="line">			<span class="tag">&lt;<span class="name">param-value</span>&gt;</span>action,,<span class="tag">&lt;/<span class="name">param-value</span>&gt;</span></span><br><span class="line">		<span class="tag">&lt;/<span class="name">init-param</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;/<span class="name">filter</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">filter-mapping</span>&gt;</span></span><br><span class="line">		<span class="tag">&lt;<span class="name">filter-name</span>&gt;</span>struts2<span class="tag">&lt;/<span class="name">filter-name</span>&gt;</span></span><br><span class="line">		<span class="tag">&lt;<span class="name">url-pattern</span>&gt;</span>/*<span class="tag">&lt;/<span class="name">url-pattern</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;/<span class="name">filter-mapping</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">web-app</span>&gt;</span></span><br></pre></td></tr></table></figure></p>
<p>Struts2所支持的常量数量众多，在<code>struts2-core-2.3.24.jar</code>压缩文件的<code>org/apache/struts2</code>路径下有一个<code>default.properties</code>文件，该文件里为Struts2的所有常量都指定了默认值，可以通过查看该文件来了解Struts2所支持的常量。<br>后加载的配置文件的常量的值会覆盖先加载的配置文件中常量的值。所以配置优先级顺序为<code>web.xml</code>、<code>struts.properties</code>、<code>struts.xml</code></p>
<h3 id="分模块开发的配置"><a href="#分模块开发的配置" class="headerlink" title="分模块开发的配置"></a>分模块开发的配置</h3><p>在实际的开发中我们更习惯使用struts.xml修改struts2的常量。但是在实际开发中还会有一个问题，就是如果一个项目是团队开发的，也就是很多人开发的，那么团队中的很多人就都需要去修改struts.xml。那么最后在项目整合的时候就会很麻烦。所以Struts2中也支持分模块开发的配置,提供了<code>&lt;include&gt;</code>标签。</p>
<p><code>&lt;include&gt;</code>元素用来在一个struts.xml配置文件中包含其他的配置文件，包含配置体现的是软件工程中的“分而治之”原则。Struts2允许将一个配置文件分解成多个配置文件，从而提高配置文件的可读性。Struts2默认只加载<code>WEB-INF/classes</code>下的struts.xml文件，但一旦通过多个xml文件来配置Action,就必须通过struts.xml文件来包含其他配置文件。为了让大家更直观地理解如何在struts.xml文件中进行包含配置，下面通过一段示例代码来说明，具体如下：<br><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">struts</span>&gt;</span></span><br><span class="line">...</span><br><span class="line"><span class="comment">&lt;!-- 包含了4个配置文件 --&gt;</span></span><br><span class="line"><span class="comment">&lt;!-- 不指定路径 默认在src下时的方式 —&gt; --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">include</span> <span class="attr">file</span>=<span class="string">"struts-shop.xml"</span>/&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">include</span> <span class="attr">file</span>=<span class="string">"struts-user.xml"</span>/&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">include</span> <span class="attr">file</span>=<span class="string">"struts-shoppingcart.xml"</span>/&gt;</span></span><br><span class="line"><span class="comment">&lt;!-- 配置文件在具体包中时的方式  --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">include</span> <span class="attr">file</span>=<span class="string">"priv/jc/action/struts-product.xml"</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">struts</span>&gt;</span></span><br></pre></td></tr></table></figure></p>
<p>需要注意的是，每一个被包含的配置文件都是标准的Struts2配置文件，一样包含DTO信息、Struts2配置文件的根元素等信息。通过将Struts2的所有配置文件都放在Web项目的WEB-INF/classes路径下，struts.xml文件包含了其他的配置文件，在Struts2框架自动加载struts.xml文件时，完成加载所有的配置信息。</p>
<h2 id="Strut2中Action的访问"><a href="#Strut2中Action的访问" class="headerlink" title="Strut2中Action的访问"></a>Strut2中Action的访问</h2><h3 id="Action类的编写方式"><a href="#Action类的编写方式" class="headerlink" title="Action类的编写方式"></a>Action类的编写方式</h3><h4 id="普通POJO类"><a href="#普通POJO类" class="headerlink" title="普通POJO类"></a>普通POJO类</h4><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">ActionDemo1</span></span>&#123;</span><br><span class="line"></span><br><span class="line">	<span class="function"><span class="keyword">public</span> String <span class="title">execute</span><span class="params">()</span></span>&#123;</span><br><span class="line">		System.out.println(<span class="string">"ActionDemo1.execute"</span>);</span><br><span class="line">		<span class="keyword">return</span> <span class="keyword">null</span>;</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>execute()方法的要求如下:</p>
<ul>
<li>方法修饰符为public</li>
<li>返回一个字符串，就是指示的下一个页面的Result</li>
<li>方法没有参数</li>
</ul>
<h4 id="实现一个Action接口"><a href="#实现一个Action接口" class="headerlink" title="实现一个Action接口"></a>实现一个Action接口</h4><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">ActionDemo2</span> <span class="keyword">implements</span> <span class="title">Action</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">	<span class="meta">@Override</span></span><br><span class="line">	<span class="function"><span class="keyword">public</span> String <span class="title">execute</span><span class="params">()</span> <span class="keyword">throws</span> Exception </span>&#123;</span><br><span class="line">		System.out.println(<span class="string">"ActionDemo2.execute"</span>);</span><br><span class="line">		<span class="keyword">return</span> <span class="keyword">null</span>;</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>Action接口<br><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.opensymphony.xwork2;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">interface</span> <span class="title">Action</span> </span>&#123;</span><br><span class="line">	String SUCCESS = <span class="string">"success"</span>;</span><br><span class="line">	String NONE = <span class="string">"none"</span>;</span><br><span class="line">	String ERROR = <span class="string">"error"</span>;</span><br><span class="line">	String INPUT = <span class="string">"input"</span>;</span><br><span class="line">	String LOGIN = <span class="string">"login"</span>;</span><br><span class="line"></span><br><span class="line">	<span class="function">String <span class="title">execute</span><span class="params">()</span> <span class="keyword">throws</span> Exception</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<p>如上，Action接口比较简单，对开发帮助较小。</p>
<h4 id="继承ActionSupport-推荐"><a href="#继承ActionSupport-推荐" class="headerlink" title="继承ActionSupport(推荐)"></a><strong>继承ActionSupport</strong>(推荐)</h4><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> com.opensymphony.xwork2.ActionSupport;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">ActionDemo3</span> <span class="keyword">extends</span> <span class="title">ActionSupport</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">	<span class="meta">@Override</span></span><br><span class="line">	<span class="function"><span class="keyword">public</span> String <span class="title">execute</span><span class="params">()</span> </span>&#123;</span><br><span class="line">		System.out.println(<span class="string">"ActionDemo3.execute"</span>);</span><br><span class="line">		<span class="keyword">return</span> NONE;</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>ActionSupport类本身实现了Action接口，是Struts2中默认的Action接口的实现类，所以继承ActionSupport就相当于实现了Action接口。ActionSupport类还实现了<code>Validateable</code>、<code>ValidationAware</code>、<code>TextProvider</code>、<code>LocaleProvider</code>和<code>Serializable</code>等接口，来为用户提供更多的功能。ActionSupport类中提供了许多默认方法，这些默认方法包括获取国际化信息的方法、数据校验的方法、默认的处理用户请求的方法等。实际上，ActionSupport类是Struts2默认的Action处理类，如果让开发者的Action类继承该ActionSupport类，则会大大简化Action的开发。</p>
<h3 id="Action的访问"><a href="#Action的访问" class="headerlink" title="Action的访问"></a>Action的访问</h3><p>测试页面<br><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">%@</span> <span class="attr">page</span> <span class="attr">contentType</span>=<span class="string">"text/html;charset=UTF-8"</span> <span class="attr">language</span>=<span class="string">"java"</span> %&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">title</span>&gt;</span>Action的访问<span class="tag">&lt;/<span class="name">title</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">a</span> <span class="attr">href</span>=<span class="string">"$&#123;pageContext.request.contextPath&#125;/saveCustomer.action"</span>&#125;&gt;</span>保存客户<span class="tag">&lt;/<span class="name">a</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">a</span> <span class="attr">href</span>=<span class="string">"$&#123;pageContext.request.contextPath&#125;/deleteCustomer.action"</span>&#125;&gt;</span>删除客户<span class="tag">&lt;/<span class="name">a</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">a</span> <span class="attr">href</span>=<span class="string">"$&#123;pageContext.request.contextPath&#125;/updateCustomer.action"</span>&#125;&gt;</span>修改客户<span class="tag">&lt;/<span class="name">a</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">a</span> <span class="attr">href</span>=<span class="string">"$&#123;pageContext.request.contextPath&#125;/findCustomer.action"</span>&#125;&gt;</span>查找客户<span class="tag">&lt;/<span class="name">a</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure></p>
<p>CustomerAction<br><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> priv.jc.action;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> com.opensymphony.xwork2.ActionSupport;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">CustomerAction</span> <span class="keyword">extends</span> <span class="title">ActionSupport</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">	<span class="function"><span class="keyword">public</span> String <span class="title">save</span><span class="params">()</span> </span>&#123;</span><br><span class="line">		System.out.println(<span class="string">"CustomerAction.save"</span>);</span><br><span class="line">		<span class="keyword">return</span> NONE;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="function"><span class="keyword">public</span> String <span class="title">delete</span><span class="params">()</span> </span>&#123;</span><br><span class="line">		System.out.println(<span class="string">"CustomerAction.delete"</span>);</span><br><span class="line">		<span class="keyword">return</span> NONE;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="function"><span class="keyword">public</span> String <span class="title">update</span><span class="params">()</span> </span>&#123;</span><br><span class="line">		System.out.println(<span class="string">"CustomerAction.update"</span>);</span><br><span class="line">		<span class="keyword">return</span> NONE;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="function"><span class="keyword">public</span> String <span class="title">find</span><span class="params">()</span> </span>&#123;</span><br><span class="line">		System.out.println(<span class="string">"CustomerAction.find"</span>);</span><br><span class="line">		<span class="keyword">return</span> NONE;</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<h4 id="通过配置method属性访问"><a href="#通过配置method属性访问" class="headerlink" title="通过配置method属性访问"></a>通过配置method属性访问</h4><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">action</span> <span class="attr">name</span>=<span class="string">"saveCustomer"</span> <span class="attr">class</span>=<span class="string">"priv.jc.action.CustomerAction"</span> <span class="attr">method</span>=<span class="string">"save"</span>&gt;</span><span class="tag">&lt;/<span class="name">action</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">action</span> <span class="attr">name</span>=<span class="string">"deleteCustomer"</span> <span class="attr">class</span>=<span class="string">"priv.jc.action.CustomerAction"</span> <span class="attr">method</span>=<span class="string">"delete"</span>&gt;</span><span class="tag">&lt;/<span class="name">action</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">action</span> <span class="attr">name</span>=<span class="string">"updateCustomer"</span> <span class="attr">class</span>=<span class="string">"priv.jc.action.CustomerAction"</span> <span class="attr">method</span>=<span class="string">"update"</span>&gt;</span><span class="tag">&lt;/<span class="name">action</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">action</span> <span class="attr">name</span>=<span class="string">"findCustomer"</span> <span class="attr">class</span>=<span class="string">"priv.jc.action.CustomerAction"</span> <span class="attr">method</span>=<span class="string">"find"</span>&gt;</span><span class="tag">&lt;/<span class="name">action</span>&gt;</span></span><br></pre></td></tr></table></figure>
<h4 id="通过通配符的配置访问"><a href="#通过通配符的配置访问" class="headerlink" title="通过通配符的配置访问"></a>通过通配符的配置访问</h4><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">action</span> <span class="attr">name</span>=<span class="string">"*Customer"</span> <span class="attr">class</span>=<span class="string">"priv.jc.action.CustomerAction"</span> <span class="attr">method</span>=<span class="string">"&#123;1&#125;"</span>&gt;</span><span class="tag">&lt;/<span class="name">action</span>&gt;</span></span><br></pre></td></tr></table></figure>
<p>这个时候我们就只配置一个就可以了，在上述代码中，当客户端发送/saveCustomer.action这样的请求时，action元素的name属性就被设置成saveCustomer，method属性就被设置成save。</p>
<h4 id="动态方法访问"><a href="#动态方法访问" class="headerlink" title="动态方法访问"></a>动态方法访问</h4><p>动态方法访问在Struts2中默认是不开启的，如果想要使用需要先去开启一个常量<br><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">constant</span> <span class="attr">name</span>=<span class="string">"struts.enable.DynamicMethodInvocation"</span> <span class="attr">value</span>=<span class="string">"true"</span>/&gt;</span></span><br></pre></td></tr></table></figure></p>
<p>配置动态访问action<br><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">action</span> <span class="attr">name</span>=<span class="string">"customerCustomer"</span> <span class="attr">class</span>=<span class="string">"priv.jc.action.CustomerAction"</span>&gt;</span><span class="tag">&lt;/<span class="name">action</span>&gt;</span></span><br></pre></td></tr></table></figure></p>
<p>页面路径写法<br><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"> <span class="tag">&lt;<span class="name">a</span> <span class="attr">href</span>=<span class="string">"$&#123;pageContext.request.contextPath&#125;/customerAction!save.action"</span>&#125;&gt;</span>保存客户<span class="tag">&lt;/<span class="name">a</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">a</span> <span class="attr">href</span>=<span class="string">"$&#123;pageContext.request.contextPath&#125;/customerAction!delete.action"</span>&#125;&gt;</span>删除客户<span class="tag">&lt;/<span class="name">a</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">a</span> <span class="attr">href</span>=<span class="string">"$&#123;pageContext.request.contextPath&#125;/customerAction!update.action"</span>&#125;&gt;</span>修改客户<span class="tag">&lt;/<span class="name">a</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">a</span> <span class="attr">href</span>=<span class="string">"$&#123;pageContext.request.contextPath&#125;/customerAction!find.action"</span>&#125;&gt;</span>查找客户<span class="tag">&lt;/<span class="name">a</span>&gt;</span></span><br></pre></td></tr></table></figure></p>
<h2 id="Struts访问servlet的API"><a href="#Struts访问servlet的API" class="headerlink" title="Struts访问servlet的API"></a>Struts访问servlet的API</h2><p>在Struts2中，Action并没有直接和ServletAPI进行耦合，也就是说在Struts2的Action中不能直接访问ServletAPI。虽然Struts2中的Action访问ServletAPI麻烦一些，但是这却是Struts2中Action的重要改良之一，方便Action进行单元测试。</p>
<p>尽管Action和ServletAPI解耦会带来很多好处，然而在Action中完全不访问ServletAPI儿乎是不可能的，在实现业务逻辑时，经常要访问Servlet中的对象，如在Struts2中，访问ServletAPI有3种方法。</p>
<h3 id="通过ActionContext访问（推荐）"><a href="#通过ActionContext访问（推荐）" class="headerlink" title="通过ActionContext访问（推荐）"></a><strong>通过ActionContext访问</strong>（推荐）</h3><p><img src="https://hexoblog-1257009793.cos.ap-shanghai.myqcloud.com/19-3-9%20Struts2%E6%80%BB%E7%BB%93%E7%AF%87/ActionContext.png" alt=""></p>
<p>ActionContext类访问ServletAPI的常用方法</p>
<table>
<thead>
<tr>
<th style="text-align:center">方法</th>
<th style="text-align:center">功能描述</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center">void put(String key,Object value)</td>
<td style="text-align:center">将key-value键值对放入ActionContext中，模拟ServletAPI中的HttpServletRequest的setAttribute()方法。</td>
</tr>
<tr>
<td style="text-align:center">Object get(String key)</td>
<td style="text-align:center">通过参数key来查找当前ActionContext中的Object get(Stringkey)值。</td>
</tr>
<tr>
<td style="text-align:center">Map&lt;String,Object&gt; getApplication()</td>
<td style="text-align:center">返回一个Application级的Map对象</td>
</tr>
<tr>
<td style="text-align:center">static ActionContext getContext()</td>
<td style="text-align:center">获取当前线程的ActionContext对象</td>
</tr>
<tr>
<td style="text-align:center">Map&lt;String,Object&gt; getParameters()</td>
<td style="text-align:center">返回一个包含所有HttpServletRequest参数信息的Map对象</td>
</tr>
<tr>
<td style="text-align:center">Map&lt;String,Object&gt; getSession()</td>
<td style="text-align:center">返回一个Map类型的HttpSession对象</td>
</tr>
<tr>
<td style="text-align:center">void setApplication(Map&lt;String,Object&gt; application)</td>
<td style="text-align:center">设置Application上下文</td>
</tr>
<tr>
<td style="text-align:center">void setSession(Map&lt;String,Object&gt; session)</td>
<td style="text-align:center">设置一个Map类型的Session值</td>
</tr>
</tbody>
</table>
<p>页面<br><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">%@</span> <span class="attr">page</span> <span class="attr">contentType</span>=<span class="string">"text/html;charset=UTF-8"</span> <span class="attr">language</span>=<span class="string">"java"</span> %&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">title</span>&gt;</span><span class="tag">&lt;/<span class="name">title</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">form</span> <span class="attr">method</span>=<span class="string">"post"</span> <span class="attr">action</span>=<span class="string">"$&#123;pageContext.request.contextPath&#125;/requestDemo1.action"</span>&gt;</span></span><br><span class="line">	username:<span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">"text"</span> <span class="attr">name</span>=<span class="string">"username"</span>&gt;</span><span class="tag">&lt;<span class="name">br</span>/&gt;</span></span><br><span class="line">	password:<span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">"password"</span> <span class="attr">name</span>=<span class="string">"password"</span>&gt;</span><span class="tag">&lt;<span class="name">br</span>/&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">"submit"</span> <span class="attr">value</span>=<span class="string">"Submit"</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">form</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">br</span>/&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">div</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">h1</span>&gt;</span>数据接受并显示<span class="tag">&lt;/<span class="name">h1</span>&gt;</span></span><br><span class="line">	username存入request:<span class="tag">&lt;<span class="name">p</span>&gt;</span>$&#123;requestUsername&#125;<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line">	password存入Session:<span class="tag">&lt;<span class="name">p</span>&gt;</span>$&#123;sessionPassword&#125;<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line">	Application:<span class="tag">&lt;<span class="name">p</span>&gt;</span>$&#123;applicationStr&#125;<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure></p>
<p>struts.xml<br><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">...</span><br><span class="line"><span class="tag">&lt;<span class="name">action</span> <span class="attr">name</span>=<span class="string">"requestDemo1"</span> <span class="attr">class</span>=<span class="string">"priv.jc.action.RequestDemo1"</span> <span class="attr">method</span>=<span class="string">"execute"</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">result</span> <span class="attr">name</span>=<span class="string">"success"</span>&gt;</span>/demo.jsp<span class="tag">&lt;/<span class="name">result</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">action</span>&gt;</span></span><br><span class="line">...</span><br></pre></td></tr></table></figure></p>
<p>Action类<br><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> priv.jc.action;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> com.opensymphony.xwork2.ActionContext;</span><br><span class="line"><span class="keyword">import</span> com.opensymphony.xwork2.ActionSupport;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.util.Map;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">RequestDemo1</span> <span class="keyword">extends</span> <span class="title">ActionSupport</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">	<span class="meta">@Override</span></span><br><span class="line">	<span class="function"><span class="keyword">public</span> String <span class="title">execute</span><span class="params">()</span> <span class="keyword">throws</span> Exception </span>&#123;</span><br><span class="line">		ActionContext actionContext = ActionContext.getContext();</span><br><span class="line">		Map&lt;String, Object&gt; parameters = actionContext.getParameters();</span><br><span class="line">		String username = ((String[]) parameters.get(<span class="string">"username"</span>))[<span class="number">0</span>];</span><br><span class="line">		String password = ((String[]) parameters.get(<span class="string">"password"</span>))[<span class="number">0</span>];</span><br><span class="line"></span><br><span class="line">		<span class="comment">// 1.将username放入request域</span></span><br><span class="line">		<span class="comment">// 获得request域（Struts2不推荐使用原生request域）</span></span><br><span class="line">		<span class="comment">// Map&lt;String, Object&gt; request = (Map&lt;String, Object&gt;) actionContext.get("request");</span></span><br><span class="line">		<span class="comment">// request.put("requestUsername", username);</span></span><br><span class="line">		actionContext.put(<span class="string">"requestUsername"</span>, username);</span><br><span class="line">		<span class="comment">// 2.将password放入Session域</span></span><br><span class="line">		Map&lt;String, Object&gt; session = actionContext.getSession();</span><br><span class="line">		session.put(<span class="string">"sessionPassword"</span>, password);</span><br><span class="line">		<span class="comment">// 3.将字符串放入application域</span></span><br><span class="line">		Map&lt;String, Object&gt; application = actionContext.getApplication();</span><br><span class="line">		application.put(<span class="string">"applicationStr"</span>, <span class="string">"username:"</span> + username + <span class="string">" , password:"</span> + password);</span><br><span class="line">		<span class="keyword">return</span> SUCCESS;</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<p>效果<br><img src="https://hexoblog-1257009793.cos.ap-shanghai.myqcloud.com/19-3-9%20Struts2%E6%80%BB%E7%BB%93%E7%AF%87/ActionContext%E7%B1%BB%E8%AE%BF%E9%97%AEServletAPI.png" alt=""></p>
<h3 id="通过特定接口访问"><a href="#通过特定接口访问" class="headerlink" title="通过特定接口访问"></a>通过特定接口访问</h3><p>Struts2框架提供了ActionContext类来访问ServletAPI，虽然这种方法可以访问ServletAPI，但是无法直接获得ServletAPI实例。为了在Action中直接访问ServletAPI,Struts2还提供了一系列接口，具体如下：</p>
<table>
<thead>
<tr>
<th style="text-align:center">接口</th>
<th style="text-align:left">说明</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center"><code>ServletRequestAware</code></td>
<td style="text-align:left">实现该接口的Action可以直接访问Web应用的HttpServletRequest</td>
</tr>
</tbody>
</table>
<p>实例。|<br>|<code>ServletResponseAware</code>|实现该接口的Action可以直接访问Web应用的HttpServletResponse<br>实例。|<br>|<code>SessionAware</code>|实现该接口的Action可以直接访问Web应用的HttpSession实例。|<br>|<code>ServletContextAware</code>|实现该接口的Action可以直接访问Web应用的ServletContext实例。|</p>
<p>以 ServletRequestAware 为例， 讲解如何在 Action 中访问 HttpServletRequest 实例<br><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> priv.jc.action;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> com.opensymphony.xwork2.ActionSupport;</span><br><span class="line"><span class="keyword">import</span> org.apache.struts2.interceptor.ServletRequestAware;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> javax.servlet.http.HttpServletRequest;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">RequestDemo2</span> <span class="keyword">extends</span> <span class="title">ActionSupport</span> <span class="keyword">implements</span> <span class="title">ServletRequestAware</span> </span>&#123;</span><br><span class="line">	HttpServletRequest reuqest;</span><br><span class="line"></span><br><span class="line">	<span class="meta">@Override</span></span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setServletRequest</span><span class="params">(javax.servlet.http.HttpServletRequest httpServletRequest)</span> </span>&#123;</span><br><span class="line">		<span class="keyword">this</span>.reuqest = reuqest;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="meta">@Override</span></span><br><span class="line">	<span class="function"><span class="keyword">public</span> String <span class="title">execute</span><span class="params">()</span> <span class="keyword">throws</span> Exception </span>&#123;</span><br><span class="line">		reuqest.setAttribute(<span class="string">"msg"</span>,<span class="string">"通过ServletRequestAware接口实现访问Servlet API"</span>);</span><br><span class="line">		<span class="keyword">return</span> SUCCESS;</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<h3 id="通过ServletActionContext访问"><a href="#通过ServletActionContext访问" class="headerlink" title="通过ServletActionContext访问"></a>通过ServletActionContext访问</h3><p>为了直接访问ServletAPI,Struts2框架还提供了ServletActionContext类，该类包含了几个常用的静态方法，具体如下：</p>
<table>
<thead>
<tr>
<th style="text-align:center">方法</th>
<th style="text-align:left">说明</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center"><code>static HttpServletRequestgetRequest()</code></td>
<td style="text-align:left">获取Web应用的HttpServletRequest对象。</td>
</tr>
<tr>
<td style="text-align:center"><code>static HttpServletResponsegetResponse()</code></td>
<td style="text-align:left">获取Web应用的HttpServletResponse对象。</td>
</tr>
<tr>
<td style="text-align:center"><code>static ServletContextgetServTletContext()</code></td>
<td style="text-align:left">获取Web应用的ServletContext对象。</td>
</tr>
<tr>
<td style="text-align:center"><code>static PageContextgetPageContext()</code></td>
<td style="text-align:left">获取Web应用的PageContext对象。</td>
</tr>
</tbody>
</table>
<p>Action类通过ServletActionContext访问<br><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> priv.jc.action;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> com.opensymphony.xwork2.ActionContext;</span><br><span class="line"><span class="keyword">import</span> com.opensymphony.xwork2.ActionSupport;</span><br><span class="line"><span class="keyword">import</span> org.apache.struts2.ServletActionContext;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> javax.servlet.ServletContext;</span><br><span class="line"><span class="keyword">import</span> javax.servlet.http.HttpServletRequest;</span><br><span class="line"><span class="keyword">import</span> javax.servlet.http.HttpSession;</span><br><span class="line"><span class="keyword">import</span> java.util.Map;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">RequestDemo1</span> <span class="keyword">extends</span> <span class="title">ActionSupport</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">	<span class="meta">@Override</span></span><br><span class="line">	<span class="function"><span class="keyword">public</span> String <span class="title">execute</span><span class="params">()</span> <span class="keyword">throws</span> Exception </span>&#123;</span><br><span class="line">		ActionContext actionContext = ActionContext.getContext();</span><br><span class="line">		Map&lt;String, Object&gt; parameters = actionContext.getParameters();</span><br><span class="line">		String username = ((String[]) parameters.get(<span class="string">"username"</span>))[<span class="number">0</span>];</span><br><span class="line">		String password = ((String[]) parameters.get(<span class="string">"password"</span>))[<span class="number">0</span>];</span><br><span class="line"></span><br><span class="line">		<span class="comment">// 1.将username放入request域</span></span><br><span class="line">		HttpServletRequest request = ServletActionContext.getRequest();</span><br><span class="line">		request.setAttribute(<span class="string">"requestUsername"</span>, username);</span><br><span class="line">		<span class="comment">// 2.将password放入Session域</span></span><br><span class="line">		HttpSession session = request.getSession();</span><br><span class="line">		session.setAttribute(<span class="string">"sessionPassword"</span>, password);</span><br><span class="line">		<span class="comment">// 3.将字符串放入application域</span></span><br><span class="line">		ServletContext servletContext = ServletActionContext.getServletContext();</span><br><span class="line">		servletContext.setAttribute(<span class="string">"applicationStr"</span>, <span class="string">"username:"</span> + username + <span class="string">" , password:"</span> + password);</span><br><span class="line">		<span class="keyword">return</span> SUCCESS;</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<p>从以上内容可以看出，借助于ServletActionContext类的帮助，开发者也可以在Action中直接访问ServletAPI，避免了Action类实现ServletRequestAware、ServletResponseAware、SessionAware和ServletContextAware等XxxAware接口。虽然如此，该Action依然与ServletAPI直接耦合，一样不利于程序解耦。综上三种访问ServletAPI的方式，建议在开发中优先使用ActionContext,以避免和ServletAPI耦合。</p>
<h2 id="Struts的结果页面"><a href="#Struts的结果页面" class="headerlink" title="Struts的结果页面"></a>Struts的结果页面</h2><p>在sturts.xml文件中，Result的配置非常简单，使用<code>&lt;result&gt;</code>元素来配置Result逻辑视图与物理视图之间的映射，<code>&lt;result&gt;</code>元素可以有name和type属性，但这两种属性都不是必选的。</p>
<ul>
<li>name:指定逻辑视图的名称，默认值为success</li>
<li>type:指定返回的视图资源的类型，不同类型代表不同的结果输出，默认的是<code>dispatcher</code></li>
</ul>
<p>在结果页面的配置中，Struts2有两种配置的方式，一种称为全局结果页面，一种称为局部结果页面。全局结果是指在这个包下的所有返回相同字符串的值，都可以向这个页面来进行跳转。局部结果是指在某个Action中返回的字符串的值，会向这个页面跳转。</p>
<h3 id="全局结果页面"><a href="#全局结果页面" class="headerlink" title="全局结果页面"></a>全局结果页面</h3><p>全局结果页面是指在同一个包下面配置的Action中返回相同的字符串的值，都可以跳转到该页<br>面。需要通过<code>&lt;global-results&gt;</code>进行配置。<br><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">global-results</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">result</span> <span class="attr">name</span>=<span class="string">"success"</span>&gt;</span>/success.jsp<span class="tag">&lt;/<span class="name">result</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">global-results</span>&gt;</span></span><br></pre></td></tr></table></figure></p>
<h3 id="局部结果变量"><a href="#局部结果变量" class="headerlink" title="局部结果变量"></a>局部结果变量</h3><p>局部结果页面是指在某个Action中根据该字符串的值进行页面的跳转。只对这个Action有效。<br><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">action</span> <span class="attr">name</span>=<span class="string">"requestDemo1"</span> <span class="attr">class</span>=<span class="string">"priv.jc.action.RequestDemo1"</span> <span class="attr">method</span>=<span class="string">"execute"</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">result</span> <span class="attr">name</span>=<span class="string">"success"</span>&gt;</span>/demo.jsp<span class="tag">&lt;/<span class="name">result</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">action</span>&gt;</span></span><br></pre></td></tr></table></figure></p>
<p>在Struts2中，当框架调用Action对请求进行处理后，就要向用户呈现一个结果视图。在Struts2中，预定义了多种ResultType，其实就是定义了多种展示结果的技术。</p>
<table>
<thead>
<tr>
<th style="text-align:center">属性</th>
<th style="text-align:left">说明</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center"><strong><code>chain</code></strong></td>
<td style="text-align:left">用来处理Action链，被跳转的Action中仍能获取上个页面的值，如request信息。</td>
</tr>
<tr>
<td style="text-align:center"><strong><code>dispatcher</code></strong></td>
<td style="text-align:left">用来转向页面，通常处理JSP,是默认的结果类型。</td>
</tr>
<tr>
<td style="text-align:center"><code>freemarker</code></td>
<td style="text-align:left">用来整合FreeMarker模板结果类型。</td>
</tr>
<tr>
<td style="text-align:center"><code>httpheader</code></td>
<td style="text-align:left">用来处理特殊的HTTP行为结果类型。</td>
</tr>
<tr>
<td style="text-align:center"><strong><code>redirect</code></strong></td>
<td style="text-align:left">重定向到一个URL,被跳转的页面中丢失传递的信息。</td>
</tr>
<tr>
<td style="text-align:center"><strong><code>redirectAction</code></strong></td>
<td style="text-align:left">重定向到一个Action,跳转的页面中丢失传递的信息。</td>
</tr>
<tr>
<td style="text-align:center"><code>stream</code></td>
<td style="text-align:left">向浏览器发送InputStream对象，通常用来处理文件下载，还可用于Ajax数据。</td>
</tr>
<tr>
<td style="text-align:center"><code>velocity</code></td>
<td style="text-align:left">用来整合Velocity模板结果类型。</td>
</tr>
<tr>
<td style="text-align:center"><code>xslt</code></td>
<td style="text-align:left">用来整合XML/XSLT结果类型。</td>
</tr>
<tr>
<td style="text-align:center"><code>plainText</code></td>
<td style="text-align:left">显示原始文件内容，例如文件源代码。</td>
</tr>
<tr>
<td style="text-align:center"><code>postback</code></td>
<td style="text-align:left">使得当前请求参数以表单形式提交。</td>
</tr>
</tbody>
</table>
<h2 id="Struts的数据封装"><a href="#Struts的数据封装" class="headerlink" title="Struts的数据封装"></a>Struts的数据封装</h2><p>Struts2将数据的封装分成两大类，一类被称为是属性驱动，一类被称为是模型驱动。</p>
<h3 id="属性驱动"><a href="#属性驱动" class="headerlink" title="属性驱动"></a>属性驱动</h3><h4 id="提供属性的set方法"><a href="#提供属性的set方法" class="headerlink" title="提供属性的set方法"></a>提供属性的set方法</h4><p>页面<br><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">%@</span> <span class="attr">page</span> <span class="attr">contentType</span>=<span class="string">"text/html;charset=UTF-8"</span> <span class="attr">language</span>=<span class="string">"java"</span> %&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">title</span>&gt;</span><span class="tag">&lt;/<span class="name">title</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">form</span> <span class="attr">method</span>=<span class="string">"post"</span> <span class="attr">action</span>=<span class="string">"$&#123;pageContext.request.contextPath&#125;/demo.action"</span>&gt;</span></span><br><span class="line">	username:<span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">"text"</span> <span class="attr">name</span>=<span class="string">"username"</span>&gt;</span><span class="tag">&lt;<span class="name">br</span>/&gt;</span></span><br><span class="line">	password:<span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">"password"</span> <span class="attr">name</span>=<span class="string">"password"</span>&gt;</span><span class="tag">&lt;<span class="name">br</span>/&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">"submit"</span> <span class="attr">value</span>=<span class="string">"Submit"</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">form</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">br</span>/&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">div</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">h1</span>&gt;</span>数据接受并显示<span class="tag">&lt;/<span class="name">h1</span>&gt;</span></span><br><span class="line">	username存入request:<span class="tag">&lt;<span class="name">p</span>&gt;</span>$&#123;requestScope.username&#125;<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line">	password存入Session:<span class="tag">&lt;<span class="name">p</span>&gt;</span>$&#123;requestScope.password&#125;<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure></p>
<p>Action类<br><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> priv.jc.action;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> com.opensymphony.xwork2.ActionContext;</span><br><span class="line"><span class="keyword">import</span> com.opensymphony.xwork2.ActionSupport;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Demo</span> <span class="keyword">extends</span> <span class="title">ActionSupport</span> </span>&#123;</span><br><span class="line">	<span class="keyword">private</span> String username;</span><br><span class="line">	<span class="keyword">private</span> String password;</span><br><span class="line"></span><br><span class="line">	<span class="meta">@Override</span></span><br><span class="line">	<span class="function"><span class="keyword">public</span> String <span class="title">execute</span><span class="params">()</span> <span class="keyword">throws</span> Exception </span>&#123;</span><br><span class="line">		System.out.println(<span class="string">"username:"</span> + username + <span class="string">",password:"</span> + password);</span><br><span class="line">		ActionContext actionContext = ActionContext.getContext();</span><br><span class="line">		actionContext.put(<span class="string">"username"</span>, username);</span><br><span class="line">		actionContext.put(<span class="string">"password"</span>, password);</span><br><span class="line">		<span class="keyword">return</span> SUCCESS;</span><br><span class="line">	&#125;</span><br><span class="line">	</span><br><span class="line">	<span class="comment">// 通过username的set方法接受username</span></span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setUsername</span><span class="params">(String username)</span> </span>&#123;</span><br><span class="line">		<span class="keyword">this</span>.username = username;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="comment">// 通过password的set方法接受password</span></span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setPassword</span><span class="params">(String password)</span> </span>&#123;</span><br><span class="line">		<span class="keyword">this</span>.password = password;</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<p>以上这种方式需要通过在Action中定义属性，并且提供属性的set方法来完成。这种方式只需要提供set方法即可。但若需要传入的数据很多的话，那Action的属性也会变得很多。再加上属性有对应的getter/setter方法，Action类的代码会很庞大，在Action里编写业务的代码时，会使Action非常臃肿，不够简洁。那么要怎样解决这个问题呢？把属性和相应的getter/setter方法从Action里提取出来，单独作为一个值对象，这个对象就是用来封装这些数据的，在相应的Action里直接使用这个对象，而且可以在多个Action里使用。采用这种方式，一般以JavaBean来实现，所封装的属性和表单的属性一一对应，JavaBean将成为数据传递的载体。</p>
<h4 id="页面使用OGNL表达式"><a href="#页面使用OGNL表达式" class="headerlink" title="页面使用OGNL表达式"></a>页面使用OGNL表达式</h4><p>页面<br><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">%@</span> <span class="attr">page</span> <span class="attr">contentType</span>=<span class="string">"text/html;charset=UTF-8"</span> <span class="attr">language</span>=<span class="string">"java"</span> %&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">title</span>&gt;</span><span class="tag">&lt;/<span class="name">title</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">form</span> <span class="attr">method</span>=<span class="string">"post"</span> <span class="attr">action</span>=<span class="string">"$&#123;pageContext.request.contextPath&#125;/demo.action"</span>&gt;</span></span><br><span class="line">	username:<span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">"text"</span> <span class="attr">name</span>=<span class="string">"user.username"</span>&gt;</span><span class="tag">&lt;<span class="name">br</span>/&gt;</span></span><br><span class="line">	password:<span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">"password"</span> <span class="attr">name</span>=<span class="string">"user.password"</span>&gt;</span><span class="tag">&lt;<span class="name">br</span>/&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">"submit"</span> <span class="attr">value</span>=<span class="string">"Submit"</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">form</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">br</span>/&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">div</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">h1</span>&gt;</span>数据接受并显示<span class="tag">&lt;/<span class="name">h1</span>&gt;</span></span><br><span class="line">	username存入request:<span class="tag">&lt;<span class="name">p</span>&gt;</span>$&#123;requestScope.username&#125;<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line">	password存入Session:<span class="tag">&lt;<span class="name">p</span>&gt;</span>$&#123;requestScope.password&#125;<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure></p>
<p>实体类<br><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> priv.jc.entity;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">User</span> </span>&#123;</span><br><span class="line">	<span class="keyword">private</span> String username;</span><br><span class="line">	<span class="keyword">private</span> String password;</span><br><span class="line"></span><br><span class="line">	<span class="function"><span class="keyword">public</span> String <span class="title">getUsername</span><span class="params">()</span> </span>&#123;</span><br><span class="line">		<span class="keyword">return</span> username;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setUsername</span><span class="params">(String username)</span> </span>&#123;</span><br><span class="line">		<span class="keyword">this</span>.username = username;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="function"><span class="keyword">public</span> String <span class="title">getPassword</span><span class="params">()</span> </span>&#123;</span><br><span class="line">		<span class="keyword">return</span> password;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setPassword</span><span class="params">(String password)</span> </span>&#123;</span><br><span class="line">		<span class="keyword">this</span>.password = password;</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<p>Action类<br><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> priv.jc.action;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> com.opensymphony.xwork2.ActionContext;</span><br><span class="line"><span class="keyword">import</span> com.opensymphony.xwork2.ActionSupport;</span><br><span class="line"><span class="keyword">import</span> priv.jc.entity.User;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Demo</span> <span class="keyword">extends</span> <span class="title">ActionSupport</span> </span>&#123;</span><br><span class="line">	<span class="keyword">private</span> User user;</span><br><span class="line"></span><br><span class="line">	<span class="meta">@Override</span></span><br><span class="line">	<span class="function"><span class="keyword">public</span> String <span class="title">execute</span><span class="params">()</span> <span class="keyword">throws</span> Exception </span>&#123;</span><br><span class="line">		String username = user.getUsername();</span><br><span class="line">		String password = user.getPassword();</span><br><span class="line">		ActionContext actionContext = ActionContext.getContext();</span><br><span class="line">		actionContext.put(<span class="string">"username"</span>, username);</span><br><span class="line">		actionContext.put(<span class="string">"password"</span>, password);</span><br><span class="line">		<span class="keyword">return</span> SUCCESS;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="function"><span class="keyword">public</span> User <span class="title">getUser</span><span class="params">()</span> </span>&#123;</span><br><span class="line">		<span class="keyword">return</span> user;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setUser</span><span class="params">(User user)</span> </span>&#123;</span><br><span class="line">		<span class="keyword">this</span>.user = user;</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<h3 id="模型驱动-推荐"><a href="#模型驱动-推荐" class="headerlink" title="模型驱动(推荐)"></a><strong>模型驱动</strong>(推荐)</h3><p>在Struts2中，Action处理请求参数还有另外一种方式，叫做模型驱动<modeldriven>。通过实现ModelDriven接口来接收请求参数，Action类必须实现ModelDriven接口，并且要重写getModel()方法，这个方法返回的就是Action所使用的数据模型对象。模型驱动方式通过JavaBean模型进行数据传递。只要是普通的JavaBean，就可以充当模型部分。采用这种方式，JavaBean所封装的属性与表单的属性一一对应，JavaBean将成为数据传递的载体。</modeldriven></p>
<p>Action类<br><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> priv.jc.action;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> com.opensymphony.xwork2.ActionContext;</span><br><span class="line"><span class="keyword">import</span> com.opensymphony.xwork2.ActionSupport;</span><br><span class="line"><span class="keyword">import</span> com.opensymphony.xwork2.ModelDriven;</span><br><span class="line"><span class="keyword">import</span> priv.jc.entity.User;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Demo</span> <span class="keyword">extends</span> <span class="title">ActionSupport</span> <span class="keyword">implements</span> <span class="title">ModelDriven</span>&lt;<span class="title">User</span>&gt; </span>&#123;</span><br><span class="line">	<span class="keyword">private</span> User user = <span class="keyword">new</span> User();</span><br><span class="line"></span><br><span class="line">	<span class="meta">@Override</span></span><br><span class="line">	<span class="function"><span class="keyword">public</span> User <span class="title">getModel</span><span class="params">()</span> </span>&#123;</span><br><span class="line">		<span class="keyword">return</span> user;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="meta">@Override</span></span><br><span class="line">	<span class="function"><span class="keyword">public</span> String <span class="title">execute</span><span class="params">()</span> <span class="keyword">throws</span> Exception </span>&#123;</span><br><span class="line">		String username = user.getUsername();</span><br><span class="line">		String password = user.getPassword();</span><br><span class="line">		ActionContext actionContext = ActionContext.getContext();</span><br><span class="line">		actionContext.put(<span class="string">"username"</span>, username);</span><br><span class="line">		actionContext.put(<span class="string">"password"</span>, password);</span><br><span class="line">		<span class="keyword">return</span> SUCCESS;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="function"><span class="keyword">public</span> User <span class="title">getUser</span><span class="params">()</span> </span>&#123;</span><br><span class="line">		<span class="keyword">return</span> user;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setUser</span><span class="params">(User user)</span> </span>&#123;</span><br><span class="line">		<span class="keyword">this</span>.user = user;</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<h3 id="集合类型数据的封装"><a href="#集合类型数据的封装" class="headerlink" title="集合类型数据的封装"></a>集合类型数据的封装</h3><h4 id="封装到List中"><a href="#封装到List中" class="headerlink" title="封装到List中"></a>封装到List中</h4><p>页面<br><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">%@</span> <span class="attr">page</span> <span class="attr">contentType</span>=<span class="string">"text/html;charset=UTF-8"</span> <span class="attr">language</span>=<span class="string">"java"</span> %&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">title</span>&gt;</span><span class="tag">&lt;/<span class="name">title</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">form</span> <span class="attr">method</span>=<span class="string">"post"</span> <span class="attr">action</span>=<span class="string">"$&#123;pageContext.request.contextPath&#125;/demo.action"</span>&gt;</span></span><br><span class="line">	username0:<span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">"text"</span> <span class="attr">name</span>=<span class="string">"list[0].username"</span>&gt;</span><span class="tag">&lt;<span class="name">br</span>/&gt;</span></span><br><span class="line">	password0:<span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">"password"</span> <span class="attr">name</span>=<span class="string">"list[0].password"</span>&gt;</span><span class="tag">&lt;<span class="name">br</span>/&gt;</span></span><br><span class="line">	username1:<span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">"text"</span> <span class="attr">name</span>=<span class="string">"list[1].username"</span>&gt;</span><span class="tag">&lt;<span class="name">br</span>/&gt;</span></span><br><span class="line">	password1:<span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">"password"</span> <span class="attr">name</span>=<span class="string">"list[1].password"</span>&gt;</span><span class="tag">&lt;<span class="name">br</span>/&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">"submit"</span> <span class="attr">value</span>=<span class="string">"Submit"</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">form</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure></p>
<p>Action类<br><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> priv.jc.action;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> com.opensymphony.xwork2.ActionSupport;</span><br><span class="line"><span class="keyword">import</span> priv.jc.entity.User;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.util.List;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Demo</span> <span class="keyword">extends</span> <span class="title">ActionSupport</span> </span>&#123;</span><br><span class="line">	<span class="keyword">private</span> List&lt;User&gt; list;</span><br><span class="line"></span><br><span class="line">	<span class="meta">@Override</span></span><br><span class="line">	<span class="function"><span class="keyword">public</span> String <span class="title">execute</span><span class="params">()</span> <span class="keyword">throws</span> Exception </span>&#123;</span><br><span class="line">		<span class="keyword">for</span> (User user : list) &#123;</span><br><span class="line">			System.out.println(user);</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="keyword">return</span> NONE;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="function"><span class="keyword">public</span> List&lt;User&gt; <span class="title">getList</span><span class="params">()</span> </span>&#123;</span><br><span class="line">		<span class="keyword">return</span> list;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setList</span><span class="params">(List&lt;User&gt; list)</span> </span>&#123;</span><br><span class="line">		<span class="keyword">this</span>.list = list;</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<h4 id="封装的map中"><a href="#封装的map中" class="headerlink" title="封装的map中"></a>封装的map中</h4><p>页面<br><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">%@</span> <span class="attr">page</span> <span class="attr">contentType</span>=<span class="string">"text/html;charset=UTF-8"</span> <span class="attr">language</span>=<span class="string">"java"</span> %&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">title</span>&gt;</span><span class="tag">&lt;/<span class="name">title</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">form</span> <span class="attr">method</span>=<span class="string">"post"</span> <span class="attr">action</span>=<span class="string">"$&#123;pageContext.request.contextPath&#125;/demo.action"</span>&gt;</span></span><br><span class="line">	username0:<span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">"text"</span> <span class="attr">name</span>=<span class="string">"map['user1'].username"</span>&gt;</span><span class="tag">&lt;<span class="name">br</span>/&gt;</span></span><br><span class="line">	password0:<span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">"password"</span> <span class="attr">name</span>=<span class="string">"map['user1'].password"</span>&gt;</span><span class="tag">&lt;<span class="name">br</span>/&gt;</span></span><br><span class="line">	username1:<span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">"text"</span> <span class="attr">name</span>=<span class="string">"map['user2'].username"</span>&gt;</span><span class="tag">&lt;<span class="name">br</span>/&gt;</span></span><br><span class="line">	password1:<span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">"password"</span> <span class="attr">name</span>=<span class="string">"map['user2'].password"</span>&gt;</span><span class="tag">&lt;<span class="name">br</span>/&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">"submit"</span> <span class="attr">value</span>=<span class="string">"Submit"</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">form</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure></p>
<p>Action类<br><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> priv.jc.action;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> com.opensymphony.xwork2.ActionSupport;</span><br><span class="line"><span class="keyword">import</span> priv.jc.entity.User;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.util.List;</span><br><span class="line"><span class="keyword">import</span> java.util.Map;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Demo</span> <span class="keyword">extends</span> <span class="title">ActionSupport</span> </span>&#123;</span><br><span class="line">	<span class="keyword">private</span> Map&lt;String, User&gt; map;</span><br><span class="line"></span><br><span class="line">	<span class="meta">@Override</span></span><br><span class="line">	<span class="function"><span class="keyword">public</span> String <span class="title">execute</span><span class="params">()</span> <span class="keyword">throws</span> Exception </span>&#123;</span><br><span class="line">		User user1 = map.get(<span class="string">"user1"</span>);</span><br><span class="line">		User user2 = map.get(<span class="string">"user2"</span>);</span><br><span class="line">		System.out.println(user1);</span><br><span class="line">		System.out.println(user2);</span><br><span class="line">		<span class="keyword">return</span> NONE;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="function"><span class="keyword">public</span> Map&lt;String, User&gt; <span class="title">getMap</span><span class="params">()</span> </span>&#123;</span><br><span class="line">		<span class="keyword">return</span> map;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setMap</span><span class="params">(Map&lt;String, User&gt; map)</span> </span>&#123;</span><br><span class="line">		<span class="keyword">this</span>.map = map;</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<h2 id="OGNL"><a href="#OGNL" class="headerlink" title="OGNL"></a>OGNL</h2><h3 id="什么是OGNL"><a href="#什么是OGNL" class="headerlink" title="什么是OGNL"></a>什么是OGNL</h3><p>OGNL的全称是对象图导航语言(Object-Graph Navigation Language),它是一种功能强大的开源表达式语言，使用这种表达式语言，可以通过某种表达式语法，存取Java对象的任意属性，调用Java对象的方法，同时能够自动实现必要的类型转换。如果把表达式看作是一个带有语义的字符串，那么OGNL无疑成为了这个语义字符串与Java对象之间沟通的桥梁。</p>
<h3 id="OGNL的作用"><a href="#OGNL的作用" class="headerlink" title="OGNL的作用"></a>OGNL的作用</h3><p>Struts2默认的表达式语言就是OGNL,它具有以下特点：</p>
<ul>
<li>支持对象方法调用。例如：objName.methodName()。</li>
<li>支持类静态方法调用和值访问，表达式的格式为@[类全名(包括包路径)]@[方法名|值名]。例如：@java.lang.String@format(‘Hello %s’,’World’)。</li>
<li>支持赋值操作和表达式串联。例如：price=100,discount=0.8,calculatePrice(),在方法中进行乘法计算会返回80。</li>
<li>访问OGNL上下文（OGNL context)和ActionContext。</li>
<li>操作集合对象</li>
</ul>
<h3 id="OGNL的要素"><a href="#OGNL的要素" class="headerlink" title="OGNL的要素"></a>OGNL的要素</h3><h4 id="表达式"><a href="#表达式" class="headerlink" title="表达式"></a>表达式</h4><p>表达式是整个OGNL的核心，OGNL会根据表达式去对象中取值。所有OGNL操作都是针对表达式解析后进行的。它表明了此次OGNL操作要“做什么”。表达式就是一个带有语法含义的字符串，这个字符串规定了操作的类型和操作的内容。OGNL支持大量的表达式语法，不仅支持这种“链式”对象访问路径，还支持在表达式中进行简单的计算。</p>
<h4 id="根对象-Root"><a href="#根对象-Root" class="headerlink" title="根对象(Root)"></a>根对象(Root)</h4><p>Root对象可理解为OGNL的操作对象，表达式规定了“做什么”，而ROOT对象规定了“对谁操作”。OGNL称为对象图导航语言，对象图即以任意一个对象为根，通过OGNL可以访问与这个对象关联的其它对象。</p>
<h4 id="Context对象"><a href="#Context对象" class="headerlink" title="Context对象"></a>Context对象</h4><p>实际上OGNL的取值还需要一个上下文环境。设置了Root对象，OGNL可以对Root对象进行取值或写值等操作，Root对象所在环境就是OGNL的上下文环境（Context)。上下文环境规定了OGNL的操作“在哪里进行”。上下文环境Context是一个Map类型的对象，在<strong>表达式中访问Context中的对象，需要使用“#”号加上对象名称，即“#对象名称”的形式</strong>。</p>
<p><img src="https://hexoblog-1257009793.cos.ap-shanghai.myqcloud.com/19-3-9%20Struts2%E6%80%BB%E7%BB%93%E7%AF%87/ognl%E8%A1%A8%E8%BE%BE%E5%BC%8F.png" alt=""></p>
<h3 id="OGNL快速入门"><a href="#OGNL快速入门" class="headerlink" title="OGNL快速入门"></a>OGNL快速入门</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Test</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">demo1</span><span class="params">()</span> <span class="keyword">throws</span> OgnlException </span>&#123;</span><br><span class="line">	<span class="comment">// 准备Root</span></span><br><span class="line">	User rootUser = <span class="keyword">new</span> User(<span class="string">"xiaoming"</span>, <span class="string">"123"</span>);</span><br><span class="line">	<span class="comment">// 准备Context</span></span><br><span class="line">	Map&lt;String, User&gt; context = <span class="keyword">new</span> HashMap&lt;String, User&gt;();</span><br><span class="line">	context.put(<span class="string">"user1"</span>, <span class="keyword">new</span> User(<span class="string">"user1"</span>, <span class="string">"password1"</span>));</span><br><span class="line">	context.put(<span class="string">"user2"</span>, <span class="keyword">new</span> User(<span class="string">"user2"</span>, <span class="string">"password2"</span>));</span><br><span class="line">	<span class="comment">// 准备OgnlContext（包含root和Context部分）</span></span><br><span class="line">	OgnlContext ognlContext = <span class="keyword">new</span> OgnlContext();</span><br><span class="line">	ognlContext.setRoot(rootUser);</span><br><span class="line">	ognlContext.setValues(context);</span><br><span class="line"></span><br><span class="line">	<span class="comment">// 1.root的取值</span></span><br><span class="line">	String username = (String) Ognl.getValue(<span class="string">"username"</span>, ognlContext, ognlContext.getRoot());</span><br><span class="line">	String password = (String) Ognl.getValue(<span class="string">"password"</span>, ognlContext, ognlContext.getRoot());</span><br><span class="line">	System.out.println(username);</span><br><span class="line">	System.out.println(password);</span><br><span class="line">	System.out.println();</span><br><span class="line"></span><br><span class="line">	<span class="comment">// 2.context的取值</span></span><br><span class="line">	String username1 = (String) Ognl.getValue(<span class="string">"#user1.username"</span>, ognlContext, ognlContext.getRoot());</span><br><span class="line">	String username2 = (String) Ognl.getValue(<span class="string">"#user2.username"</span>, ognlContext, ognlContext.getRoot());</span><br><span class="line">	String password2 = (String) Ognl.getValue(<span class="string">"#user2.password"</span>, ognlContext, ognlContext.getRoot());</span><br><span class="line">	System.out.println(username1);</span><br><span class="line">	System.out.println(username2);</span><br><span class="line">	System.out.println(password2);</span><br><span class="line">	System.out.println();</span><br><span class="line"></span><br><span class="line">	<span class="comment">// 3.root的赋值</span></span><br><span class="line">	Ognl.getValue(<span class="string">"username='test'"</span>, ognlContext, ognlContext.getRoot());</span><br><span class="line">	String username3 = (String) Ognl.getValue(<span class="string">"username"</span>, ognlContext, ognlContext.getRoot());</span><br><span class="line">	System.out.println(username3);</span><br><span class="line">	System.out.println();</span><br><span class="line"></span><br><span class="line">	<span class="comment">// 4.context的赋值(同时赋值并取值)</span></span><br><span class="line">	String username4 = (String) Ognl.getValue(<span class="string">"#user1.username='test1',#user1.username"</span>, ognlContext, ognlContext.getRoot());</span><br><span class="line">	System.out.println(username4);</span><br><span class="line">	System.out.println();</span><br><span class="line"></span><br><span class="line">	<span class="comment">// 5.调用方法</span></span><br><span class="line">	Ognl.getValue(<span class="string">"setUsername('haha')"</span>, ognlContext, ognlContext.getRoot());</span><br><span class="line">	String username5 = (String) Ognl.getValue(<span class="string">"getUsername()"</span>, ognlContext, ognlContext.getRoot());</span><br><span class="line">	System.out.println(username5);</span><br><span class="line">	String password5 = (String) Ognl.getValue(<span class="string">"#user1.setPassword('testPassword'),#user1.getPassword()"</span>, ognlContext, ognlContext.getRoot());</span><br><span class="line">	System.out.println(password5);</span><br><span class="line">	System.out.println();</span><br><span class="line"></span><br><span class="line">	<span class="comment">// 6.静态方法和静态属性</span></span><br><span class="line">	<span class="comment">// 调用对象的静态方法 @包名@方法名称(参数列表)</span></span><br><span class="line">	<span class="comment">// Double value = (Double) Ognl.getValue("@java.lang.Math@floor(3.14)", ognlContext, ognlContext.getRoot());</span></span><br><span class="line">	<span class="comment">// 当静态方法或属性在自带包中，包名可省略</span></span><br><span class="line">	Double value = (Double) Ognl.getValue(<span class="string">"@@floor(3.14)"</span>, ognlContext, ognlContext.getRoot());</span><br><span class="line">	System.out.println(value);</span><br><span class="line">	<span class="comment">// 调用对象的属性名称  @包名@属性名称</span></span><br><span class="line">	<span class="comment">// Double value1 = (Double) Ognl.getValue("@java.lang.Math@PI", ognlContext, ognlContext.getRoot());</span></span><br><span class="line">	Double value1 = (Double) Ognl.getValue(<span class="string">"@@PI"</span>, ognlContext, ognlContext.getRoot());</span><br><span class="line">	System.out.println(value1);</span><br><span class="line">	System.out.println();</span><br><span class="line"></span><br><span class="line">	<span class="comment">// 7.创建List对象（在root中）</span></span><br><span class="line">	Integer size = (Integer) Ognl.getValue(<span class="string">"&#123;'haha','hehe','heihei'&#125;.size()"</span>, ognlContext, ognlContext.getRoot());</span><br><span class="line">	String str = (String) Ognl.getValue(<span class="string">"&#123;'haha','hehe','heihei'&#125;[2]"</span>, ognlContext, ognlContext.getRoot());</span><br><span class="line">	List&lt;String&gt; list = (List&lt;String&gt;) Ognl.getValue(<span class="string">"&#123;'haha','hehe','heihei'&#125;"</span>, ognlContext, ognlContext.getRoot());</span><br><span class="line">	System.out.println(size);</span><br><span class="line">	System.out.println(str);</span><br><span class="line">	System.out.println(list);</span><br><span class="line">	System.out.println();</span><br><span class="line"></span><br><span class="line">	<span class="comment">// 8.创建Map对象（在context中）</span></span><br><span class="line">	Integer size1 = (Integer) Ognl.getValue(<span class="string">"#&#123;'name':'zhangsan','age':'18'&#125;.size()"</span>, ognlContext, ognlContext.getRoot());</span><br><span class="line">	String name = (String) Ognl.getValue(<span class="string">"#&#123;'name':'zhangsan','age':18&#125;.get('name')"</span>, ognlContext, ognlContext.getRoot());</span><br><span class="line">	Integer age = (Integer) Ognl.getValue(<span class="string">"#&#123;'name':'zhangsan','age':18&#125;['age']"</span>, ognlContext, ognlContext.getRoot());</span><br><span class="line">	Map&lt;String, Object&gt; map = (Map&lt;String, Object&gt;) Ognl.getValue(<span class="string">"#&#123;'name':'zhangsan','age':18&#125;"</span>, ognlContext, ognlContext.getRoot());</span><br><span class="line">	System.out.println(size1);</span><br><span class="line">	System.out.println(name);</span><br><span class="line">	System.out.println(age);</span><br><span class="line">	System.out.println(map);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h2 id="Struts2与OGNL的结合"><a href="#Struts2与OGNL的结合" class="headerlink" title="Struts2与OGNL的结合"></a>Struts2与OGNL的结合</h2><h3 id="值栈"><a href="#值栈" class="headerlink" title="值栈"></a>值栈</h3><p>ValueStack是Struts的一个接口，字面意义为值钱，OgnlValueStack是ValueStack的实现类，客户端发起一个请求struts2架构会创建一个action实例同时创建一个OgnlValueStack值栈实例，OgnlValueStack贯穿整个Action的生命周期，struts2中使用OGNL将请求Action的参数封装为对象存储到值栈中，并通过OGNL表达式读取值栈中的对象属性值。</p>
<h3 id="值栈内部结构"><a href="#值栈内部结构" class="headerlink" title="值栈内部结构"></a>值栈内部结构</h3><p>在OnglValueStack中包括两部分，值栈和ognl上下文(是个Map)<br><img src="https://hexoblog-1257009793.cos.ap-shanghai.myqcloud.com/19-3-9%20Struts2%E6%80%BB%E7%BB%93%E7%AF%87/Struts2%E4%B8%8EOGNL%E8%A1%A8%E8%BE%BE%E5%BC%8F%E7%9A%84%E7%BB%93%E5%90%88.png" alt=""></p>
<h4 id="OGNL上下文"><a href="#OGNL上下文" class="headerlink" title="OGNL上下文"></a>OGNL上下文</h4><p>Context:即OgnlContext上下文，它是一个map结构，上下文中存储了一些引用，parameters、request、session、application等，上下文的Root为CompoundRoot。</p>
<ul>
<li>OgnlContext中的一些引用:<ul>
<li>parameters:该Map中包含当前请求的请求参数</li>
<li>request:该Map中包含当前request对象中的所有属性</li>
<li>session:该Map中包含当前session对象中的所有属性</li>
<li>application:该Map中包含当前application对象中的所有属性</li>
<li>attr：该Map按如下顺序来检索某个属性:request、session、application</li>
</ul>
</li>
</ul>
<h4 id="值栈-1"><a href="#值栈-1" class="headerlink" title="值栈"></a>值栈</h4><p>CompoundRoot：存储了action实例，它作为OgnlContext的Root对象。</p>
<p>CompoundRoot继承ArrayList实现压栈和出栈功能，拥有栈的特点，先进后出，后进先出，最后压进栈的数据在栈顶。我们把它称为对象栈。</p>
<p>struts2对原OGNL作出的改进就是Root使用CompoundRoot(自定义栈)，使用OnglValueStack的findValue方法可以在CompoundRoot中从栈顶向栈底找查找的对象的属性值。</p>
<p>CompoundRoot作为OgnlContext的Root对象，并且在CompoundRoot中action实例位于栈顶，当读取action的属性值时会先从栈顶对象中找对应的属性，如果找不到则继续找栈中的其它对象，如果找到则停止查找。</p>
<h3 id="Struts2与OGNL的结合体现"><a href="#Struts2与OGNL的结合体现" class="headerlink" title="Struts2与OGNL的结合体现"></a>Struts2与OGNL的结合体现</h3><h4 id="参数接受"><a href="#参数接受" class="headerlink" title="参数接受"></a>参数接受</h4><p><img src="https://hexoblog-1257009793.cos.ap-shanghai.myqcloud.com/19-3-9%20Struts2%E6%80%BB%E7%BB%93%E7%AF%87/%E5%8F%82%E6%95%B0%E6%8E%A5%E5%8F%97-%E5%B1%9E%E6%80%A7%E9%A9%B1%E5%8A%A8.png" alt=""><br><img src="https://hexoblog-1257009793.cos.ap-shanghai.myqcloud.com/19-3-9%20Struts2%E6%80%BB%E7%BB%93%E7%AF%87/%E5%8F%82%E6%95%B0%E6%8E%A5%E5%8F%97-%E5%AF%B9%E8%B1%A1%E9%A9%B1%E5%8A%A8.png" alt=""><br><img src="https://hexoblog-1257009793.cos.ap-shanghai.myqcloud.com/19-3-9%20Struts2%E6%80%BB%E7%BB%93%E7%AF%87/%E5%8F%82%E6%95%B0%E6%8E%A5%E5%8F%97-%E6%A8%A1%E5%9E%8B%E9%A9%B1%E5%8A%A8.png" alt=""></p>
<h3 id="配置文件中参数传递"><a href="#配置文件中参数传递" class="headerlink" title="配置文件中参数传递"></a>配置文件中参数传递</h3><p>作用：用OGNL表达式将变量传递从一个Action传递到另一个Action中<br><img src="https://hexoblog-1257009793.cos.ap-shanghai.myqcloud.com/19-3-9%20Struts2%E6%80%BB%E7%BB%93%E7%AF%87/%E9%85%8D%E7%BD%AE%E6%96%87%E4%BB%B6%E4%B8%AD%E5%8F%82%E6%95%B0%E4%BC%A0%E9%80%92.png" alt=""></p>
<h3 id="Struts2标签"><a href="#Struts2标签" class="headerlink" title="Struts2标签"></a>Struts2标签</h3><h4 id="普通标签"><a href="#普通标签" class="headerlink" title="普通标签"></a>普通标签</h4><h5 id="iterator"><a href="#iterator" class="headerlink" title="iterator"></a>iterator</h5><table>
<thead>
<tr>
<th style="text-align:center">属性</th>
<th style="text-align:center">是否必须</th>
<th style="text-align:center">默认值</th>
<th style="text-align:center">类型</th>
<th style="text-align:left">描述</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center">begin</td>
<td style="text-align:center">否</td>
<td style="text-align:center">0</td>
<td style="text-align:center">Integer</td>
<td style="text-align:left">迭代数组或集合的起始位置</td>
</tr>
<tr>
<td style="text-align:center">end</td>
<td style="text-align:center">否</td>
<td style="text-align:center">数组或集合的长度大小减1，假如step为负则为0</td>
<td style="text-align:center">Integer</td>
<td style="text-align:left">迭代数组或集合的结束位置</td>
</tr>
<tr>
<td style="text-align:center">status</td>
<td style="text-align:center">否</td>
<td style="text-align:center">false</td>
<td style="text-align:center">Boolean</td>
<td style="text-align:left">迭代过程状态</td>
</tr>
<tr>
<td style="text-align:center">step</td>
<td style="text-align:center">否</td>
<td style="text-align:center">1</td>
<td style="text-align:center">Integer</td>
<td style="text-align:left">步长</td>
</tr>
<tr>
<td style="text-align:center">value</td>
<td style="text-align:center">否</td>
<td style="text-align:center">无</td>
<td style="text-align:center">String</td>
<td style="text-align:left">迭代的数组或集合对象</td>
</tr>
<tr>
<td style="text-align:center">var</td>
<td style="text-align:center">否</td>
<td style="text-align:center">无</td>
<td style="text-align:center">String</td>
<td style="text-align:left">将生成的Iterator设置为page范围的属性</td>
</tr>
<tr>
<td style="text-align:center">id</td>
<td style="text-align:center">否</td>
<td style="text-align:center">无</td>
<td style="text-align:center">String</td>
<td style="text-align:left">指定了集合元素的id，现用var代替</td>
</tr>
</tbody>
</table>
<p>如果在&lt;s:iterator&gt;标签中指定status属性，那么通过该属性可以获取迭代过程中的状态信息，如：元素数、当前索引值等。</p>
<table>
<thead>
<tr>
<th style="text-align:center">方法</th>
<th style="text-align:left">说明</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center">status.count</td>
<td style="text-align:left">返回当前已遍历元素个数</td>
</tr>
<tr>
<td style="text-align:center">status.first</td>
<td style="text-align:left">返回当前遍历元素是否为集合第一个元素</td>
</tr>
<tr>
<td style="text-align:center">status.last</td>
<td style="text-align:left">返回当前遍历元素是否为集合最后一个元素</td>
</tr>
<tr>
<td style="text-align:center">status.index</td>
<td style="text-align:left">返回当前遍历元素的索引</td>
</tr>
<tr>
<td style="text-align:center">status.even</td>
<td style="text-align:left">返回当前遍历的元素的索引是否为偶数</td>
</tr>
<tr>
<td style="text-align:center">status.odd</td>
<td style="text-align:left">返回当前遍历的元素的索引是否为奇数</td>
</tr>
</tbody>
</table>
<figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line">&lt;%@ taglib prefix=<span class="string">"s"</span> uri=<span class="string">"/struts-tags"</span> %&gt;</span><br><span class="line">&lt;%@ page contentType=<span class="string">"text/html;charset=UTF-8"</span> language=<span class="string">"java"</span> %&gt;</span><br><span class="line">&lt;html&gt;</span><br><span class="line">&lt;head&gt;</span><br><span class="line">	&lt;title&gt;iterator&lt;/title&gt;</span><br><span class="line">&lt;/head&gt;</span><br><span class="line">&lt;body&gt;</span><br><span class="line">&lt;table&gt;</span><br><span class="line">	&lt;s:iterator var=<span class="string">"str"</span> status=<span class="string">"st"</span> value=<span class="string">"&#123;'a','b','c','d','e'&#125;"</span>&gt;</span><br><span class="line">		&lt;s:<span class="keyword">if</span> test=<span class="string">"#st.odd"</span>&gt;</span><br><span class="line">			&lt;tr style=<span class="string">"background-color: darkolivegreen"</span>&gt;</span><br><span class="line">				&lt;td&gt;&lt;s:property value="str"/&gt;&lt;/td&gt;</span><br><span class="line">			&lt;/tr&gt;</span><br><span class="line">		&lt;/s:if&gt;</span><br><span class="line">		&lt;s:<span class="keyword">else</span>&gt;</span><br><span class="line">			&lt;tr style=<span class="string">"background-color: cornflowerblue"</span>&gt;</span><br><span class="line">				&lt;td&gt;&lt;s:property value="str"/&gt;&lt;/td&gt;</span><br><span class="line">			&lt;/tr&gt;</span><br><span class="line">		&lt;/s:else&gt;</span><br><span class="line">	&lt;/s:iterator&gt;</span><br><span class="line">&lt;/table&gt;</span><br><span class="line"></span><br><span class="line">&lt;%--s:iterator 不加var 会将每个值都放到栈顶--%&gt;</span><br><span class="line">&lt;s:iterator begin=<span class="string">"0"</span> end=<span class="string">"100"</span> step=<span class="string">"2"</span>&gt;</span><br><span class="line">	&lt;%--默认从栈顶取值--%&gt;</span><br><span class="line">	&lt;s:property/&gt;</span><br><span class="line">&lt;/s:iterator&gt;</span><br><span class="line">&lt;br/&gt;</span><br><span class="line">&lt;%--s:iterator 加var 会将每个值都放到ActionContext中--%&gt;</span><br><span class="line">&lt;s:iterator begin=<span class="string">"0"</span> end=<span class="string">"100"</span> step=<span class="string">"4"</span> var=<span class="string">"num"</span>&gt;</span><br><span class="line">	&lt;s:property value=<span class="string">"#num"</span>/&gt;</span><br><span class="line">&lt;/s:iterator&gt;</span><br><span class="line">&lt;/body&gt;</span><br><span class="line">&lt;/html&gt;</span><br></pre></td></tr></table></figure>
<h5 id="if、else、elseif"><a href="#if、else、elseif" class="headerlink" title="if、else、elseif"></a>if、else、elseif</h5><figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">&lt;s:<span class="keyword">if</span> test=<span class="string">"#list.size()==4"</span>&gt;</span><br><span class="line">	list长度为<span class="number">4</span></span><br><span class="line">&lt;/s:if&gt;</span><br><span class="line">&lt;s:elseif test=<span class="string">"#list.size()==3"</span>&gt;</span><br><span class="line">	list长度为<span class="number">3</span></span><br><span class="line">&lt;/s:elseif&gt;</span><br><span class="line">&lt;s:<span class="keyword">else</span>&gt;</span><br><span class="line">	list长度不为<span class="number">3</span>和<span class="number">4</span></span><br><span class="line">&lt;/s:else&gt;</span><br></pre></td></tr></table></figure>
<h5 id="property"><a href="#property" class="headerlink" title="property"></a>property</h5><table>
<thead>
<tr>
<th style="text-align:center">属性</th>
<th style="text-align:left">说明</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center">id</td>
<td style="text-align:left">可选，指定元素标识</td>
</tr>
<tr>
<td style="text-align:center">default</td>
<td style="text-align:left">可选，若输出元素为null，则显示default指定的值</td>
</tr>
<tr>
<td style="text-align:center">escape</td>
<td style="text-align:left">可选，是否忽略html代码，true为忽略，若不选则默认忽略</td>
</tr>
<tr>
<td style="text-align:center">value</td>
<td style="text-align:left">可选，指定需要输出的属性值，若没有指定，默认输出ValueStack栈顶的值</td>
</tr>
</tbody>
</table>
<figure class="highlight jsp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">&lt;s:property value=<span class="string">"#list.size()"</span>/&gt;</span><br><span class="line">&lt;s:property value=<span class="string">"#session.user.username"</span>&gt;</span><br><span class="line">&lt;s:property value=<span class="string">""</span> <span class="keyword">default</span>=<span class="string">"test"</span>/&gt;</span><br><span class="line">&lt;s:property value=<span class="string">"'&lt;h1&gt;Hello&lt;/h1&gt;'"</span>/&gt;</span><br><span class="line">&lt;s:property value=<span class="string">"'&lt;h1&gt;Hello&lt;/h1&gt;'"</span> escape=<span class="string">"false"</span>/&gt;</span><br></pre></td></tr></table></figure>
<h5 id="a"><a href="#a" class="headerlink" title="a"></a>a</h5><table>
<thead>
<tr>
<th style="text-align:center">属性</th>
<th style="text-align:left">说明</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center">action</td>
<td style="text-align:left">可选，指定超链接action地址</td>
</tr>
<tr>
<td style="text-align:center">href</td>
<td style="text-align:left">可选，指定超链接地址</td>
</tr>
<tr>
<td style="text-align:center">namespace</td>
<td style="text-align:left">可选，指定action命名空间</td>
</tr>
<tr>
<td style="text-align:center">id</td>
<td style="text-align:left">可选，指定id</td>
</tr>
<tr>
<td style="text-align:center">method</td>
<td style="text-align:left">可选，指定action调用方法</td>
</tr>
</tbody>
</table>
<p><code>&lt;s:a action=&quot;${pageContext.request.contextPath}/loginAction!toIndex.action&quot;&gt;&lt;/s:a&gt;</code></p>
<h5 id="debug"><a href="#debug" class="headerlink" title="debug"></a>debug</h5><p>&lt;s:debug&gt;标签用于在调试程序时输出更多的调试信息，主要输出ValueStack和StackContext中的信息，该标签只有一个id属性，且一般不使用。</p>
<h4 id="UI标签"><a href="#UI标签" class="headerlink" title="UI标签"></a>UI标签</h4><h5 id="表单标签-一般不使用"><a href="#表单标签-一般不使用" class="headerlink" title="表单标签(一般不使用)"></a>表单标签(一般不使用)</h5><p><img src="https://hexoblog-1257009793.cos.ap-shanghai.myqcloud.com/19-3-9%20Struts2%E6%80%BB%E7%BB%93%E7%AF%87/%E8%A1%A8%E5%8D%95%E6%A0%87%E7%AD%BE.png" alt=""></p>
<h5 id="actionerror"><a href="#actionerror" class="headerlink" title="actionerror"></a>actionerror</h5><p>在action中添加错误信息<br><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">this</span>.addActionError(<span class="string">"用户名或密码错误!"</span>);</span><br></pre></td></tr></table></figure></p>
<p>页面显示<br><figure class="highlight jsp"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;s:actionerror/&gt;</span><br></pre></td></tr></table></figure></p>
<h2 id="拦截器"><a href="#拦截器" class="headerlink" title="拦截器"></a>拦截器</h2><h3 id="什么是拦截器"><a href="#什么是拦截器" class="headerlink" title="什么是拦截器"></a>什么是拦截器</h3><p>拦截器，在AOP(Aspect-OrientedProgramming)中用于在某个方法或字段被访问之前，进行拦截然后在之前或之后加入某些操作。拦截是AOP的一种实现策略。</p>
<p>在Webwork的中文文档的解释为—拦截器是动态拦截Action调用的对象。它提供了一种机制可以使开发者可以定义在一个action执行的前后执行的代码，也可以在一个action执行前阻止其执行。同时也是提供了一种可以提取action中可重用的部分的方式。</p>
<p>拦截器链（Interceptor Chain，在Struts2中称为拦截器栈Interceptor Stack)就是将拦截器按一定的顺序联结成一条链。在<strong>访问被拦截的方法或字段</strong>时，拦截器链中的拦截器就会<strong>按其之前定义的顺序被调用</strong>。</p>
<h3 id="拦截器实现原理"><a href="#拦截器实现原理" class="headerlink" title="拦截器实现原理"></a>拦截器实现原理</h3><p>大部分时候，拦截器方法通过代理的方式被调用，Struts2的拦截器实现是当请求到达Struts2的ServletDispatcher时，Strut2查找配置文件，并根据其配置实例化对应的拦截器对象，然后串成一个列表，最后一个个调用列表中的拦截器。</p>
<h3 id="Struts执行流程"><a href="#Struts执行流程" class="headerlink" title="Struts执行流程"></a>Struts执行流程</h3><p><img src="https://hexoblog-1257009793.cos.ap-shanghai.myqcloud.com/19-3-9%20Struts2%E6%80%BB%E7%BB%93%E7%AF%87/Struts2%E6%89%A7%E8%A1%8C%E6%B5%81%E7%A8%8B.png" alt=""></p>
<h3 id="自定义拦截器的方式"><a href="#自定义拦截器的方式" class="headerlink" title="自定义拦截器的方式"></a>自定义拦截器的方式</h3><h4 id="实现Interceptor接口"><a href="#实现Interceptor接口" class="headerlink" title="实现Interceptor接口"></a>实现Interceptor接口</h4><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> priv.jc.interceptor;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> com.opensymphony.xwork2.ActionInvocation;</span><br><span class="line"><span class="keyword">import</span> com.opensymphony.xwork2.interceptor.Interceptor;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 需要实现 init()、intercept()、destroy()三个方法</span></span><br><span class="line"><span class="comment">// 生命周期：随项目启动而创建，项目关闭而销毁</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">InterceptorTest</span> <span class="keyword">implements</span> <span class="title">Interceptor</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">	<span class="meta">@Override</span></span><br><span class="line">	<span class="comment">// 该方法与init()方法相对应，在拦截器实例被销毁之前，将调用该方法来释放和拦截器相关的资源。它在拦截器的生命周期内，也只被调用一次。</span></span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">destroy</span><span class="params">()</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="meta">@Override</span></span><br><span class="line">	<span class="comment">// 该方法在拦截器被创建后会立即被调用，它在拦截器的生命周期内只被调用一次.可以在该方法中对相关资源进行必要的初始化。</span></span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">init</span><span class="params">()</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="meta">@Override</span></span><br><span class="line">	<span class="comment">/*拦截器的核心方法，用来添加真正执行拦截工作的代码，实现具体的拦截操作。</span></span><br><span class="line"><span class="comment">	它返回一个字符串作为逻辑视图，系统根据返回的字符串跳转到对应的视图资源。每拦截一个动作请求，该方法就会被调用一次。</span></span><br><span class="line"><span class="comment">	该方法的ActionInvocation参数包含了被拦截的Action的引用，可以通过该参数的invoke()方法，将控制权转给下一个拦截器或者转给Action的execute()方法。*/</span></span><br><span class="line">	<span class="function"><span class="keyword">public</span> String <span class="title">intercept</span><span class="params">(ActionInvocation actionInvocation)</span> <span class="keyword">throws</span> Exception </span>&#123;</span><br><span class="line">		<span class="keyword">return</span> <span class="keyword">null</span>;</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h4 id="继承AbstractInterceptor拦截器类"><a href="#继承AbstractInterceptor拦截器类" class="headerlink" title="继承AbstractInterceptor拦截器类"></a>继承AbstractInterceptor拦截器类</h4><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> priv.jc.interceptor;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> com.opensymphony.xwork2.ActionInvocation;</span><br><span class="line"><span class="keyword">import</span> com.opensymphony.xwork2.interceptor.AbstractInterceptor;</span><br><span class="line"></span><br><span class="line"><span class="comment">// AbstractInterceptor实现了Interceptor类 空实现了init()和destroy()方法 所以我们只需要实现intercept方法即可</span></span><br><span class="line"><span class="comment">// 生命周期：随项目启动而创建，项目关闭而销毁</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">AbstractInterceptorTest</span> <span class="keyword">extends</span> <span class="title">AbstractInterceptor</span> </span>&#123;</span><br><span class="line">	<span class="meta">@Override</span></span><br><span class="line">	<span class="function"><span class="keyword">public</span> String <span class="title">intercept</span><span class="params">(ActionInvocation actionInvocation)</span> <span class="keyword">throws</span> Exception </span>&#123;</span><br><span class="line">		<span class="keyword">return</span> <span class="keyword">null</span>;</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h4 id="继承MethodFilterInterceptor方法拦截器"><a href="#继承MethodFilterInterceptor方法拦截器" class="headerlink" title="继承MethodFilterInterceptor方法拦截器"></a>继承MethodFilterInterceptor方法拦截器</h4><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> priv.jc.interceptor;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> com.opensymphony.xwork2.ActionInvocation;</span><br><span class="line"><span class="keyword">import</span> com.opensymphony.xwork2.interceptor.MethodFilterInterceptor;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 方法拦截过滤器</span></span><br><span class="line"><span class="comment">// 定制哪些方法拦截 哪些方法不拦截</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">MethodFilterInterceptorTest</span> <span class="keyword">extends</span> <span class="title">MethodFilterInterceptor</span> </span>&#123;</span><br><span class="line">	<span class="meta">@Override</span></span><br><span class="line">	<span class="function"><span class="keyword">protected</span> String <span class="title">doIntercept</span><span class="params">(ActionInvocation actionInvocation)</span> <span class="keyword">throws</span> Exception </span>&#123;</span><br><span class="line">		<span class="keyword">return</span> <span class="keyword">null</span>;</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="拦截器常用API"><a href="#拦截器常用API" class="headerlink" title="拦截器常用API"></a>拦截器常用API</h3><p>放行<code>invocation.invoke();</code></p>
<p>不放行<code>return &quot;success&quot;;</code>(不执行后续的拦截器以及Action,直接交给Result处理结果.进行页面跳转)</p>
<h3 id="配置拦截器"><a href="#配置拦截器" class="headerlink" title="配置拦截器"></a>配置拦截器</h3><p>login.jsp<br><figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line">&lt;%@ page contentType=<span class="string">"text/html;charset=UTF-8"</span> language=<span class="string">"java"</span> %&gt;</span><br><span class="line">&lt;html&gt;</span><br><span class="line">&lt;head&gt;</span><br><span class="line">	&lt;title&gt;登陆页面&lt;/title&gt;</span><br><span class="line">	&lt;style type=<span class="string">"text/css"</span>&gt;</span><br><span class="line">		table &#123;</span><br><span class="line">			margin: <span class="number">200</span>px auto;</span><br><span class="line">		&#125;</span><br><span class="line">	&lt;/style&gt;</span><br><span class="line">&lt;/head&gt;</span><br><span class="line">&lt;body&gt;</span><br><span class="line">&lt;form method=<span class="string">"post"</span> action=<span class="string">"$&#123;pageContext.request.contextPath&#125;/loginAction!login.action"</span>&gt;</span><br><span class="line">	&lt;table&gt;</span><br><span class="line">		&lt;tr&gt;</span><br><span class="line">			&lt;td&gt;用户名：&lt;/td&gt;</span><br><span class="line">			&lt;td&gt;&lt;input type="text" name="username"/&gt;&lt;/td&gt;</span><br><span class="line">		&lt;/tr&gt;</span><br><span class="line">		&lt;tr&gt;</span><br><span class="line">			&lt;td&gt;密码：&lt;/td&gt;</span><br><span class="line">			&lt;td&gt;&lt;input type="password" name="password"/&gt;&lt;/td&gt;</span><br><span class="line">		&lt;/tr&gt;</span><br><span class="line">		&lt;tr&gt;</span><br><span class="line">			&lt;td&gt;&lt;/td&gt;</span><br><span class="line">			&lt;td&gt;&lt;input type="submit" value="登陆"/&gt;&lt;/td&gt;</span><br><span class="line">		&lt;/tr&gt;</span><br><span class="line">	&lt;/table&gt;</span><br><span class="line">&lt;/form&gt;</span><br><span class="line">&lt;/body&gt;</span><br><span class="line">&lt;/html&gt;</span><br></pre></td></tr></table></figure></p>
<p>User.java<br><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> priv.jc.entity;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">User</span> </span>&#123;</span><br><span class="line">	<span class="keyword">private</span> String username;</span><br><span class="line">	<span class="keyword">private</span> String password;</span><br><span class="line"></span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="title">User</span><span class="params">()</span> </span>&#123;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="function"><span class="keyword">public</span> String <span class="title">getUsername</span><span class="params">()</span> </span>&#123;</span><br><span class="line">		<span class="keyword">return</span> username;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setUsername</span><span class="params">(String username)</span> </span>&#123;</span><br><span class="line">		<span class="keyword">this</span>.username = username;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="function"><span class="keyword">public</span> String <span class="title">getPassword</span><span class="params">()</span> </span>&#123;</span><br><span class="line">		<span class="keyword">return</span> password;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setPassword</span><span class="params">(String password)</span> </span>&#123;</span><br><span class="line">		<span class="keyword">this</span>.password = password;</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<p>LoginAction.java<br><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> priv.jc.action;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> com.opensymphony.xwork2.ActionContext;</span><br><span class="line"><span class="keyword">import</span> com.opensymphony.xwork2.ActionSupport;</span><br><span class="line"><span class="keyword">import</span> com.opensymphony.xwork2.ModelDriven;</span><br><span class="line"><span class="keyword">import</span> priv.jc.entity.User;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">LoginAction</span> <span class="keyword">extends</span> <span class="title">ActionSupport</span> <span class="keyword">implements</span> <span class="title">ModelDriven</span>&lt;<span class="title">User</span>&gt; </span>&#123;</span><br><span class="line">	<span class="keyword">private</span> User user = <span class="keyword">new</span> User();</span><br><span class="line"></span><br><span class="line">	<span class="function"><span class="keyword">public</span> String <span class="title">toIndexPage</span><span class="params">()</span> </span>&#123;</span><br><span class="line">		<span class="keyword">return</span> <span class="string">"index"</span>;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="function"><span class="keyword">public</span> String <span class="title">login</span><span class="params">()</span> </span>&#123;</span><br><span class="line">		<span class="keyword">boolean</span> isUserExist = isUserExist(user);</span><br><span class="line">		<span class="keyword">if</span> (isUserExist) &#123;</span><br><span class="line">			ActionContext.getContext().getSession().put(<span class="string">"user"</span>, user);</span><br><span class="line">			<span class="keyword">return</span> <span class="string">"index"</span>;</span><br><span class="line">		&#125; <span class="keyword">else</span> &#123;</span><br><span class="line">			<span class="keyword">this</span>.addActionError(<span class="string">"用户不存在或密码错误"</span>);</span><br><span class="line">			<span class="keyword">return</span> <span class="string">"login"</span>;</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="comment">// 判断用户是否账号密码正确</span></span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">boolean</span> <span class="title">isUserExist</span><span class="params">(User user)</span> </span>&#123;</span><br><span class="line">		<span class="keyword">boolean</span> isExist = <span class="keyword">false</span>;</span><br><span class="line">		String username = <span class="string">"admin"</span>;</span><br><span class="line">		String password = <span class="string">"123456"</span>;</span><br><span class="line">		<span class="keyword">if</span> (username.equals(user.getUsername()) &amp;&amp; password.equals(user.getPassword())) &#123;</span><br><span class="line">			isExist = <span class="keyword">true</span>;</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="keyword">return</span> isExist;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="meta">@Override</span></span><br><span class="line">	<span class="function"><span class="keyword">public</span> User <span class="title">getModel</span><span class="params">()</span> </span>&#123;</span><br><span class="line">		<span class="keyword">return</span> user;</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<p>LoginInterceptor.java<br><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> priv.jc.interceptor;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> com.opensymphony.xwork2.ActionInvocation;</span><br><span class="line"><span class="keyword">import</span> com.opensymphony.xwork2.interceptor.MethodFilterInterceptor;</span><br><span class="line"><span class="keyword">import</span> org.apache.struts2.ServletActionContext;</span><br><span class="line"><span class="keyword">import</span> priv.jc.entity.User;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">LoginInterceptor</span> <span class="keyword">extends</span> <span class="title">MethodFilterInterceptor</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">	<span class="meta">@Override</span></span><br><span class="line">	<span class="function"><span class="keyword">protected</span> String <span class="title">doIntercept</span><span class="params">(ActionInvocation actionInvocation)</span> <span class="keyword">throws</span> Exception </span>&#123;</span><br><span class="line">		User user = (User) ServletActionContext.getRequest().getSession().getAttribute(<span class="string">"user"</span>);</span><br><span class="line">		<span class="keyword">if</span> (user == <span class="keyword">null</span>) &#123;</span><br><span class="line">			<span class="keyword">return</span> <span class="string">"error"</span>;</span><br><span class="line">		&#125; <span class="keyword">else</span> &#123;</span><br><span class="line">			<span class="keyword">return</span> actionInvocation.invoke();</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<p>Struts2.xml<br><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;!DOCTYPE struts PUBLIC</span></span><br><span class="line"><span class="meta">		"-//Apache Software Foundation//DTD Struts Configuration 2.3//EN"</span></span><br><span class="line"><span class="meta">		"http://struts.apache.org/dtds/struts-2.3.dtd"&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">struts</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">package</span> <span class="attr">name</span>=<span class="string">"hello"</span> <span class="attr">extends</span>=<span class="string">"struts-default"</span> <span class="attr">namespace</span>=<span class="string">"/"</span>&gt;</span></span><br><span class="line"></span><br><span class="line">		<span class="tag">&lt;<span class="name">interceptors</span>&gt;</span></span><br><span class="line">			<span class="comment">&lt;!--1.注册拦截器--&gt;</span></span><br><span class="line">			<span class="tag">&lt;<span class="name">interceptor</span> <span class="attr">name</span>=<span class="string">"loginInterceptor"</span> <span class="attr">class</span>=<span class="string">"priv.jc.interceptor.LoginInterceptor"</span>&gt;</span></span><br><span class="line">				<span class="comment">&lt;!--2.指定拦截哪些方法，不拦截哪些方法--&gt;</span></span><br><span class="line">				<span class="comment">&lt;!--指定哪些方法不拦截--&gt;</span></span><br><span class="line">				<span class="tag">&lt;<span class="name">param</span> <span class="attr">name</span>=<span class="string">"excludeMethods"</span>&gt;</span>login<span class="tag">&lt;/<span class="name">param</span>&gt;</span></span><br><span class="line">				<span class="comment">&lt;!--指定哪些方法拦截--&gt;</span></span><br><span class="line">				<span class="tag">&lt;<span class="name">param</span> <span class="attr">name</span>=<span class="string">"includeMethods"</span>&gt;</span>toIndexPage<span class="tag">&lt;/<span class="name">param</span>&gt;</span></span><br><span class="line">			<span class="tag">&lt;/<span class="name">interceptor</span>&gt;</span></span><br><span class="line">			<span class="comment">&lt;!--3.注册拦截器栈--&gt;</span></span><br><span class="line">			<span class="tag">&lt;<span class="name">interceptor-stack</span> <span class="attr">name</span>=<span class="string">"my-stack"</span>&gt;</span></span><br><span class="line">				<span class="comment">&lt;!--引入自定义拦截器--&gt;</span></span><br><span class="line">				<span class="tag">&lt;<span class="name">interceptor-ref</span> <span class="attr">name</span>=<span class="string">"loginInterceptor"</span>&gt;</span><span class="tag">&lt;/<span class="name">interceptor-ref</span>&gt;</span></span><br><span class="line">				<span class="comment">&lt;!--引用默认的拦截器栈(内有20个拦截器)--&gt;</span></span><br><span class="line">				<span class="tag">&lt;<span class="name">interceptor-ref</span> <span class="attr">name</span>=<span class="string">"defaultStack"</span>&gt;</span><span class="tag">&lt;/<span class="name">interceptor-ref</span>&gt;</span></span><br><span class="line">			<span class="tag">&lt;/<span class="name">interceptor-stack</span>&gt;</span></span><br><span class="line">		<span class="tag">&lt;/<span class="name">interceptors</span>&gt;</span></span><br><span class="line">		<span class="comment">&lt;!--4.指定包中默认的拦截器栈--&gt;</span></span><br><span class="line">		<span class="tag">&lt;<span class="name">default-interceptor-ref</span> <span class="attr">name</span>=<span class="string">"my-stack"</span>&gt;</span><span class="tag">&lt;/<span class="name">default-interceptor-ref</span>&gt;</span></span><br><span class="line"></span><br><span class="line">		<span class="comment">&lt;!--全局结果集--&gt;</span></span><br><span class="line">		<span class="tag">&lt;<span class="name">global-results</span>&gt;</span></span><br><span class="line">			<span class="tag">&lt;<span class="name">result</span> <span class="attr">name</span>=<span class="string">"login"</span>&gt;</span>login.jsp<span class="tag">&lt;/<span class="name">result</span>&gt;</span></span><br><span class="line">		<span class="tag">&lt;/<span class="name">global-results</span>&gt;</span></span><br><span class="line">		<span class="tag">&lt;<span class="name">action</span> <span class="attr">name</span>=<span class="string">"loginAction"</span> <span class="attr">class</span>=<span class="string">"priv.jc.action.LoginAction"</span>&gt;</span></span><br><span class="line">			<span class="comment">&lt;!--4.指定action中的默认拦截器栈--&gt;</span></span><br><span class="line">			<span class="comment">&lt;!--&lt;interceptor-ref name="my-stack"&gt;&lt;/interceptor-ref&gt;--&gt;</span></span><br><span class="line">			<span class="tag">&lt;<span class="name">result</span> <span class="attr">name</span>=<span class="string">"index"</span>&gt;</span>/index.jsp<span class="tag">&lt;/<span class="name">result</span>&gt;</span></span><br><span class="line">			<span class="tag">&lt;<span class="name">result</span> <span class="attr">name</span>=<span class="string">"login"</span>&gt;</span>/login.jsp<span class="tag">&lt;/<span class="name">result</span>&gt;</span></span><br><span class="line">			<span class="tag">&lt;<span class="name">result</span> <span class="attr">name</span>=<span class="string">"error"</span>&gt;</span>/error.jsp<span class="tag">&lt;/<span class="name">result</span>&gt;</span></span><br><span class="line">		<span class="tag">&lt;/<span class="name">action</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;/<span class="name">package</span>&gt;</span></span><br><span class="line"></span><br><span class="line">	<span class="comment">&lt;!-- 设置默认编码集为UTF-8--&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">constant</span> <span class="attr">name</span>=<span class="string">"struts.i18n.encoding"</span> <span class="attr">value</span>=<span class="string">"UTF-8"</span>/&gt;</span></span><br><span class="line">	<span class="comment">&lt;!-- 设置使用开发模式--&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">constant</span> <span class="attr">name</span>=<span class="string">"struts.devMode"</span> <span class="attr">value</span>=<span class="string">"true"</span>/&gt;</span></span><br><span class="line">	<span class="comment">&lt;!-- 设置开启使用动态方法调用--&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">constant</span> <span class="attr">name</span>=<span class="string">"struts.enable.DynamicMethodInvocation"</span> <span class="attr">value</span>=<span class="string">"true"</span>/&gt;</span></span><br><span class="line">	<span class="comment">&lt;!-- 设置action请求的拓展名为action 或 没有拓展名--&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">constant</span> <span class="attr">name</span>=<span class="string">"struts.action.extension"</span> <span class="attr">value</span>=<span class="string">"action,,"</span>/&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">struts</span>&gt;</span></span><br></pre></td></tr></table></figure></p>

      
    </div>
    
    
    

  <div>
    
    <div>
    
        <div style="text-align:center;color: #555;font-size:14px;">-------------The End-------------</div>
    
</div>
    
  </div>

    

    

    

    <footer class="post-footer">
      
        <div class="post-tags">
          
            <a href="/tags/Struts2/" rel="tag"><i class="fa fa-tag"></i>Struts2</a>
          
        </div>
      

      
      
      

      
        <div class="post-nav">
          <div class="post-nav-next post-nav-item">
            
              <a href="/2019/02/24/Hibernate总结篇/" rel="next" title="Hibernate总结篇">
                <i class="fa fa-chevron-left"></i> Hibernate总结篇
              </a>
            
          </div>

          <span class="post-nav-divider"></span>

          <div class="post-nav-prev post-nav-item">
            
              <a href="/2019/03/26/Spring总结篇/" rel="prev" title="Spring总结篇">
                Spring总结篇 <i class="fa fa-chevron-right"></i>
              </a>
            
          </div>
        </div>
      

      
      
    </footer>
  </div>
  
  
  
  </article>



    <div class="post-spread">
      
    </div>
  </div>


          </div>
          


          

  



        </div>
        
          
  
  <div class="sidebar-toggle">
    <div class="sidebar-toggle-line-wrap">
      <span class="sidebar-toggle-line sidebar-toggle-line-first"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-middle"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-last"></span>
    </div>
  </div>

  <aside id="sidebar" class="sidebar">
    
    <div class="sidebar-inner">

      

      
        <ul class="sidebar-nav motion-element">
          <li class="sidebar-nav-toc sidebar-nav-active" data-target="post-toc-wrap">
            Table of Contents
          </li>
          <li class="sidebar-nav-overview" data-target="site-overview-wrap">
            Overview
          </li>
        </ul>
      

      <section class="site-overview-wrap sidebar-panel">
        <div class="site-overview">
          <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
            
              <img class="site-author-image" itemprop="image"
                src="/images/avatar.jpg"
                alt="JiachengLai" />
            
              <p class="site-author-name" itemprop="name">JiachengLai</p>
              <p class="site-description motion-element" itemprop="description">纸上得来终觉浅，绝知此事要躬行</p>
          </div>

          <nav class="site-state motion-element">

            
              <div class="site-state-item site-state-posts">
              
                <a href="/archives/">
              
                  <span class="site-state-item-count">21</span>
                  <span class="site-state-item-name">posts</span>
                </a>
              </div>
            

            
              
              
              <div class="site-state-item site-state-categories">
                <a href="/categories/index.html">
                  <span class="site-state-item-count">8</span>
                  <span class="site-state-item-name">categories</span>
                </a>
              </div>
            

            
              
              
              <div class="site-state-item site-state-tags">
                
                  <span class="site-state-item-count">14</span>
                  <span class="site-state-item-name">tags</span>
                
              </div>
            

          </nav>

          

          

          
          

          
          

          

        </div>
      </section>

      
      <!--noindex-->
        <section class="post-toc-wrap motion-element sidebar-panel sidebar-panel-active">
          <div class="post-toc">

            
              
            

            
              <div class="post-toc-content"><ol class="nav"><li class="nav-item nav-level-2"><a class="nav-link" href="#什么是Struts2"><span class="nav-number">1.</span> <span class="nav-text">什么是Struts2</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Struts2的优点"><span class="nav-number">2.</span> <span class="nav-text">Struts2的优点</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#快速入门"><span class="nav-number">3.</span> <span class="nav-text">快速入门</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#JAR包导入"><span class="nav-number">3.1.</span> <span class="nav-text">JAR包导入</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#创建测试页面"><span class="nav-number">3.2.</span> <span class="nav-text">创建测试页面</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#书写Action类"><span class="nav-number">3.3.</span> <span class="nav-text">书写Action类</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#书写struts-xml"><span class="nav-number">3.4.</span> <span class="nav-text">书写struts.xml</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#配置struts2核心过滤器"><span class="nav-number">3.5.</span> <span class="nav-text">配置struts2核心过滤器</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#效果"><span class="nav-number">3.6.</span> <span class="nav-text">效果</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Struts2的执行流程"><span class="nav-number">3.7.</span> <span class="nav-text">Struts2的执行流程</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Struts2的常见配置"><span class="nav-number">4.</span> <span class="nav-text">Struts2的常见配置</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#Struts2配置文件的加载顺序"><span class="nav-number">4.1.</span> <span class="nav-text">Struts2配置文件的加载顺序</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Action的配置"><span class="nav-number">4.2.</span> <span class="nav-text">Action的配置</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Struts2常量的配置"><span class="nav-number">4.3.</span> <span class="nav-text">Struts2常量的配置</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#分模块开发的配置"><span class="nav-number">4.4.</span> <span class="nav-text">分模块开发的配置</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Strut2中Action的访问"><span class="nav-number">5.</span> <span class="nav-text">Strut2中Action的访问</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#Action类的编写方式"><span class="nav-number">5.1.</span> <span class="nav-text">Action类的编写方式</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#普通POJO类"><span class="nav-number">5.1.1.</span> <span class="nav-text">普通POJO类</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#实现一个Action接口"><span class="nav-number">5.1.2.</span> <span class="nav-text">实现一个Action接口</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#继承ActionSupport-推荐"><span class="nav-number">5.1.3.</span> <span class="nav-text">继承ActionSupport(推荐)</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Action的访问"><span class="nav-number">5.2.</span> <span class="nav-text">Action的访问</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#通过配置method属性访问"><span class="nav-number">5.2.1.</span> <span class="nav-text">通过配置method属性访问</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#通过通配符的配置访问"><span class="nav-number">5.2.2.</span> <span class="nav-text">通过通配符的配置访问</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#动态方法访问"><span class="nav-number">5.2.3.</span> <span class="nav-text">动态方法访问</span></a></li></ol></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Struts访问servlet的API"><span class="nav-number">6.</span> <span class="nav-text">Struts访问servlet的API</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#通过ActionContext访问（推荐）"><span class="nav-number">6.1.</span> <span class="nav-text">通过ActionContext访问（推荐）</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#通过特定接口访问"><span class="nav-number">6.2.</span> <span class="nav-text">通过特定接口访问</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#通过ServletActionContext访问"><span class="nav-number">6.3.</span> <span class="nav-text">通过ServletActionContext访问</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Struts的结果页面"><span class="nav-number">7.</span> <span class="nav-text">Struts的结果页面</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#全局结果页面"><span class="nav-number">7.1.</span> <span class="nav-text">全局结果页面</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#局部结果变量"><span class="nav-number">7.2.</span> <span class="nav-text">局部结果变量</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Struts的数据封装"><span class="nav-number">8.</span> <span class="nav-text">Struts的数据封装</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#属性驱动"><span class="nav-number">8.1.</span> <span class="nav-text">属性驱动</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#提供属性的set方法"><span class="nav-number">8.1.1.</span> <span class="nav-text">提供属性的set方法</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#页面使用OGNL表达式"><span class="nav-number">8.1.2.</span> <span class="nav-text">页面使用OGNL表达式</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#模型驱动-推荐"><span class="nav-number">8.2.</span> <span class="nav-text">模型驱动(推荐)</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#集合类型数据的封装"><span class="nav-number">8.3.</span> <span class="nav-text">集合类型数据的封装</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#封装到List中"><span class="nav-number">8.3.1.</span> <span class="nav-text">封装到List中</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#封装的map中"><span class="nav-number">8.3.2.</span> <span class="nav-text">封装的map中</span></a></li></ol></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#OGNL"><span class="nav-number">9.</span> <span class="nav-text">OGNL</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#什么是OGNL"><span class="nav-number">9.1.</span> <span class="nav-text">什么是OGNL</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#OGNL的作用"><span class="nav-number">9.2.</span> <span class="nav-text">OGNL的作用</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#OGNL的要素"><span class="nav-number">9.3.</span> <span class="nav-text">OGNL的要素</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#表达式"><span class="nav-number">9.3.1.</span> <span class="nav-text">表达式</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#根对象-Root"><span class="nav-number">9.3.2.</span> <span class="nav-text">根对象(Root)</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#Context对象"><span class="nav-number">9.3.3.</span> <span class="nav-text">Context对象</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#OGNL快速入门"><span class="nav-number">9.4.</span> <span class="nav-text">OGNL快速入门</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Struts2与OGNL的结合"><span class="nav-number">10.</span> <span class="nav-text">Struts2与OGNL的结合</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#值栈"><span class="nav-number">10.1.</span> <span class="nav-text">值栈</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#值栈内部结构"><span class="nav-number">10.2.</span> <span class="nav-text">值栈内部结构</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#OGNL上下文"><span class="nav-number">10.2.1.</span> <span class="nav-text">OGNL上下文</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#值栈-1"><span class="nav-number">10.2.2.</span> <span class="nav-text">值栈</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Struts2与OGNL的结合体现"><span class="nav-number">10.3.</span> <span class="nav-text">Struts2与OGNL的结合体现</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#参数接受"><span class="nav-number">10.3.1.</span> <span class="nav-text">参数接受</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#配置文件中参数传递"><span class="nav-number">10.4.</span> <span class="nav-text">配置文件中参数传递</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Struts2标签"><span class="nav-number">10.5.</span> <span class="nav-text">Struts2标签</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#普通标签"><span class="nav-number">10.5.1.</span> <span class="nav-text">普通标签</span></a><ol class="nav-child"><li class="nav-item nav-level-5"><a class="nav-link" href="#iterator"><span class="nav-number">10.5.1.1.</span> <span class="nav-text">iterator</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#if、else、elseif"><span class="nav-number">10.5.1.2.</span> <span class="nav-text">if、else、elseif</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#property"><span class="nav-number">10.5.1.3.</span> <span class="nav-text">property</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#a"><span class="nav-number">10.5.1.4.</span> <span class="nav-text">a</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#debug"><span class="nav-number">10.5.1.5.</span> <span class="nav-text">debug</span></a></li></ol></li><li class="nav-item nav-level-4"><a class="nav-link" href="#UI标签"><span class="nav-number">10.5.2.</span> <span class="nav-text">UI标签</span></a><ol class="nav-child"><li class="nav-item nav-level-5"><a class="nav-link" href="#表单标签-一般不使用"><span class="nav-number">10.5.2.1.</span> <span class="nav-text">表单标签(一般不使用)</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#actionerror"><span class="nav-number">10.5.2.2.</span> <span class="nav-text">actionerror</span></a></li></ol></li></ol></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#拦截器"><span class="nav-number">11.</span> <span class="nav-text">拦截器</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#什么是拦截器"><span class="nav-number">11.1.</span> <span class="nav-text">什么是拦截器</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#拦截器实现原理"><span class="nav-number">11.2.</span> <span class="nav-text">拦截器实现原理</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Struts执行流程"><span class="nav-number">11.3.</span> <span class="nav-text">Struts执行流程</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#自定义拦截器的方式"><span class="nav-number">11.4.</span> <span class="nav-text">自定义拦截器的方式</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#实现Interceptor接口"><span class="nav-number">11.4.1.</span> <span class="nav-text">实现Interceptor接口</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#继承AbstractInterceptor拦截器类"><span class="nav-number">11.4.2.</span> <span class="nav-text">继承AbstractInterceptor拦截器类</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#继承MethodFilterInterceptor方法拦截器"><span class="nav-number">11.4.3.</span> <span class="nav-text">继承MethodFilterInterceptor方法拦截器</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#拦截器常用API"><span class="nav-number">11.5.</span> <span class="nav-text">拦截器常用API</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#配置拦截器"><span class="nav-number">11.6.</span> <span class="nav-text">配置拦截器</span></a></li></ol></li></ol></div>
            

          </div>
        </section>
      <!--/noindex-->
      

      

    </div>
  </aside>


        
      </div>
    </main>

    <footer id="footer" class="footer">
      <div class="footer-inner">
        <div class="copyright">&copy; <span itemprop="copyrightYear">2019</span>
  <span class="with-love">
    <i class="fa fa-user"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">JiachengLai</span>

  
</div>









        







        
      </div>
    </footer>

    
      <div class="back-to-top">
        <i class="fa fa-arrow-up"></i>
        
      </div>
    

    

  </div>

  

<script type="text/javascript">
  if (Object.prototype.toString.call(window.Promise) !== '[object Function]') {
    window.Promise = null;
  }
</script>









  












  
  
    <script type="text/javascript" src="/lib/jquery/index.js?v=2.1.3"></script>
  

  
  
    <script type="text/javascript" src="/lib/fastclick/lib/fastclick.min.js?v=1.0.6"></script>
  

  
  
    <script type="text/javascript" src="/lib/jquery_lazyload/jquery.lazyload.js?v=1.9.7"></script>
  

  
  
    <script type="text/javascript" src="/lib/velocity/velocity.min.js?v=1.2.1"></script>
  

  
  
    <script type="text/javascript" src="/lib/velocity/velocity.ui.min.js?v=1.2.1"></script>
  

  
  
    <script type="text/javascript" src="/lib/fancybox/source/jquery.fancybox.pack.js?v=2.1.5"></script>
  


  


  <script type="text/javascript" src="/js/src/utils.js?v=5.1.4"></script>

  <script type="text/javascript" src="/js/src/motion.js?v=5.1.4"></script>



  
  


  <script type="text/javascript" src="/js/src/affix.js?v=5.1.4"></script>

  <script type="text/javascript" src="/js/src/schemes/pisces.js?v=5.1.4"></script>



  
  <script type="text/javascript" src="/js/src/scrollspy.js?v=5.1.4"></script>
<script type="text/javascript" src="/js/src/post-details.js?v=5.1.4"></script>



  


  <script type="text/javascript" src="/js/src/bootstrap.js?v=5.1.4"></script>



  


  




	





  





  












  





  

  

  

  
  

  

  

  

  <script type="text/javascript" src="/js/src/love.js"></script>
</body>
</html>
